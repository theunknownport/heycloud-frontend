{"ast":null,"code":"import { exportImage, geometry, Group, MultiPath, Path, Image, Surface } from '@progress/kendo-drawing';\nimport { elementOffset, limitValue } from '../common';\nvar Point = geometry.Point,\n    Rect = geometry.Rect,\n    transform = geometry.transform;\n\nvar noop = function () {};\n\nvar DECIMAL_DIGITS = 3;\nvar DEFAULT_COLOR = '#000';\nvar DEFAULT_BACKGROUND_COLOR = '#fff';\nvar DEFAULT_PRECISION = 1;\nvar DEFAULT_SAMPLING_RATE = 200; // Updates per second\n\nvar DEFAULT_STROKE_WIDTH = 1;\nvar DEFAULT_WIDTH = 750;\nvar DEFAULT_HEIGHT = 250;\nvar DEFAULT_SCALE = 1; // Export images at maximized scale (3x) and 2x pixel density to cover HiDPI screens.\n\nvar DEFAULT_EXPORT_SCALE = 6;\n\nvar SignaturePad =\n/** @class */\nfunction () {\n  function SignaturePad(element, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.element = element;\n    this.lastMoveTime = 0;\n    this.options = Object.assign({\n      scale: DEFAULT_SCALE,\n      precision: DEFAULT_PRECISION,\n      samplingRate: DEFAULT_SAMPLING_RATE,\n      smooth: options.smooth !== false,\n      color: options.color || DEFAULT_COLOR,\n      backgroundColor: options.backgroundColor || DEFAULT_BACKGROUND_COLOR,\n      strokeWidth: DEFAULT_STROKE_WIDTH,\n      onChange: noop,\n      onDraw: noop,\n      onDrawEnd: noop\n    }, options);\n    this.pathOptions = {\n      stroke: {\n        color: this.options.color,\n        width: this.options.strokeWidth,\n        lineCap: 'round',\n        lineJoin: 'round'\n      }\n    };\n    this.initSurface();\n    this.attachEvents();\n  }\n\n  SignaturePad.prototype.destroy = function () {\n    this.detachEvents();\n  };\n\n  SignaturePad.prototype.clear = function () {\n    this.rootGroup.clear();\n    this.path = null;\n  };\n\n  Object.defineProperty(SignaturePad.prototype, \"isDrawing\", {\n    get: function () {\n      return Boolean(this.points);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(SignaturePad.prototype, \"pathData\", {\n    get: function () {\n      var _a;\n\n      return (_a = this.path) === null || _a === void 0 ? void 0 : _a.toString(DECIMAL_DIGITS);\n    },\n    set: function (value) {\n      this.clear();\n      this.path = MultiPath.parse(value, this.pathOptions);\n      this.rootGroup.append(this.path);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  SignaturePad.prototype.loadImage = function (data, size) {\n    if (size === void 0) {\n      size = [];\n    }\n\n    if (!data) {\n      this.clear();\n      return;\n    }\n\n    var _a = this.size,\n        width = _a[0],\n        height = _a[1];\n    var contentWidth = width / this.options.scale;\n    var contentHeight = height / this.options.scale;\n    var importWidth = size[0] || contentWidth * DEFAULT_EXPORT_SCALE;\n    var importHeight = size[1] || contentHeight * DEFAULT_EXPORT_SCALE;\n    var scaleX = contentWidth / importWidth;\n    var scaleY = contentHeight / importHeight;\n    var scale = Math.min(scaleX, scaleY);\n    var img = new Image(data, new geometry.Rect([0, 0], [importWidth, importHeight]));\n    img.transform(transform().scale(scale, scale));\n    this.clear();\n    this.rootGroup.append(img);\n  };\n\n  SignaturePad.prototype.exportImage = function (options) {\n    var _a;\n\n    var _b = this.size,\n        width = _b[0],\n        height = _b[1];\n    var contentWidth = width / this.options.scale;\n    var contentHeight = height / this.options.scale;\n    var exportWidth = (options === null || options === void 0 ? void 0 : options.width) || contentWidth * DEFAULT_EXPORT_SCALE;\n    var exportHeight = (options === null || options === void 0 ? void 0 : options.height) || contentHeight * DEFAULT_EXPORT_SCALE;\n    var scaleX = exportWidth / contentWidth;\n    var scaleY = exportHeight / contentHeight;\n    var scale = Math.min(scaleX, scaleY);\n    var exportRect = new Rect([0, 0], [exportWidth, exportHeight]);\n    var exportGroup = new Group({\n      clip: Path.fromRect(exportRect)\n    });\n    var contentGroup = new Group({\n      transform: transform().scale(scale, scale)\n    });\n    var frame = Path.fromRect(exportRect, {\n      fill: {\n        color: this.options.backgroundColor\n      }\n    });\n    exportGroup.append(frame);\n    exportGroup.append(contentGroup);\n\n    (_a = contentGroup.children).push.apply(_a, this.rootGroup.children);\n\n    return exportImage(exportGroup, Object.assign({\n      width: exportWidth,\n      height: exportHeight\n    }, options));\n  };\n\n  SignaturePad.prototype.resize = function () {\n    this.surface.resize(true);\n  };\n\n  SignaturePad.prototype.setOptions = function (options) {\n    Object.assign(this.options, options);\n    this.pathOptions.stroke.color = this.options.color;\n    this.pathOptions.stroke.width = this.options.strokeWidth;\n\n    if (this.path) {\n      this.path.options.set('stroke.color', this.options.color);\n      this.path.options.set('stroke.width', this.options.strokeWidth);\n    }\n\n    this.background.options.set('fill.color', this.options.backgroundColor);\n  };\n\n  SignaturePad.prototype.initSurface = function () {\n    this.surface = Surface.create(this.element, {\n      type: 'canvas'\n    });\n    this.element.style.touchAction = 'none';\n    var scale = this.options.scale;\n    this.rootGroup = new Group({\n      transform: transform().scale(scale, scale)\n    }); // The signature is not resizable, store initial dimensions.\n\n    var width = this.element.offsetWidth || DEFAULT_WIDTH;\n    var height = this.element.offsetHeight || DEFAULT_HEIGHT;\n    this.size = [width, height];\n    this.background = Path.fromRect(new Rect([0, 0], this.size), {\n      fill: {\n        color: this.options.backgroundColor\n      }\n    });\n    this.surface.draw(this.background);\n    this.surface.draw(this.rootGroup);\n  };\n\n  SignaturePad.prototype.attachEvents = function () {\n    this.onPointerDown = this.onPointerDown.bind(this);\n    this.onPointerMove = this.onPointerMove.bind(this);\n    this.onPointerUp = this.onPointerUp.bind(this);\n    this.element.addEventListener('pointerdown', this.onPointerDown);\n    this.element.addEventListener('pointermove', this.onPointerMove);\n    this.element.addEventListener('pointerup', this.onPointerUp);\n  };\n\n  SignaturePad.prototype.detachEvents = function () {\n    this.element.removeEventListener('pointerdown', this.onPointerDown);\n    this.element.removeEventListener('pointermove', this.onPointerMove);\n    this.element.removeEventListener('pointerup', this.onPointerUp);\n  };\n\n  SignaturePad.prototype.touchPoint = function (e) {\n    var offset = elementOffset(this.element);\n    var pageX = e.pageX;\n    var pageY = e.pageY;\n    var scale = 1 / this.options.scale;\n    return new Point(pageX - offset.left, pageY - offset.top).scale(scale, scale);\n  };\n\n  SignaturePad.prototype.onPointerDown = function (e) {\n    if (this.options.readonly || !e.isPrimary || !isMainButton(e)) {\n      return;\n    }\n\n    if (!this.path) {\n      this.path = new MultiPath(this.pathOptions);\n      this.rootGroup.append(this.path);\n    }\n\n    this.options.onDraw();\n    this.element.setPointerCapture(e.pointerId);\n    var point = this.touchPoint(e);\n    this.points = [point];\n    this.path.moveTo(point);\n  };\n\n  SignaturePad.prototype.onPointerMove = function (e) {\n    if (!this.points || !e.isPrimary) {\n      return;\n    }\n\n    var now = new Date().getTime();\n    var elapsed = now - this.lastMoveTime;\n    var minTimeDelta = 1000 / limitValue(this.options.samplingRate, 1, 10000);\n\n    if (elapsed < minTimeDelta) {\n      return;\n    } else {\n      this.lastMoveTime = now;\n    }\n\n    var point = this.touchPoint(e);\n    var lastPoint = this.points[this.points.length - 1];\n    var minDelta = 1 / limitValue(this.options.precision, 0.01, 100);\n\n    if (point.distanceTo(lastPoint) < minDelta) {\n      return;\n    }\n\n    this.points.push(point);\n    this.path.lineTo(point);\n  };\n\n  SignaturePad.prototype.onPointerUp = function (e) {\n    if (!e.isPrimary || !this.path || !this.points || this.options.readonly) {\n      return;\n    }\n\n    if (this.options.smooth) {\n      var segments = Path.curveFromPoints(this.points);\n      this.path.paths.splice(this.path.paths.length - 1, 1, segments);\n    }\n\n    this.points = null;\n    this.options.onDrawEnd();\n    this.options.onChange(this.pathData);\n  };\n\n  return SignaturePad;\n}();\n\nexport { SignaturePad };\n\nfunction isMainButton(e) {\n  return typeof e.button !== 'number' || e.button === 0;\n}","map":{"version":3,"sources":["C:/Projects/React/heycloud-frontent-2/node_modules/@progress/kendo-inputs-common/dist/es/signature/signature-pad.js"],"names":["exportImage","geometry","Group","MultiPath","Path","Image","Surface","elementOffset","limitValue","Point","Rect","transform","noop","DECIMAL_DIGITS","DEFAULT_COLOR","DEFAULT_BACKGROUND_COLOR","DEFAULT_PRECISION","DEFAULT_SAMPLING_RATE","DEFAULT_STROKE_WIDTH","DEFAULT_WIDTH","DEFAULT_HEIGHT","DEFAULT_SCALE","DEFAULT_EXPORT_SCALE","SignaturePad","element","options","lastMoveTime","Object","assign","scale","precision","samplingRate","smooth","color","backgroundColor","strokeWidth","onChange","onDraw","onDrawEnd","pathOptions","stroke","width","lineCap","lineJoin","initSurface","attachEvents","prototype","destroy","detachEvents","clear","rootGroup","path","defineProperty","get","Boolean","points","enumerable","configurable","_a","toString","set","value","parse","append","loadImage","data","size","height","contentWidth","contentHeight","importWidth","importHeight","scaleX","scaleY","Math","min","img","_b","exportWidth","exportHeight","exportRect","exportGroup","clip","fromRect","contentGroup","frame","fill","children","push","apply","resize","surface","setOptions","background","create","type","style","touchAction","offsetWidth","offsetHeight","draw","onPointerDown","bind","onPointerMove","onPointerUp","addEventListener","removeEventListener","touchPoint","e","offset","pageX","pageY","left","top","readonly","isPrimary","isMainButton","setPointerCapture","pointerId","point","moveTo","now","Date","getTime","elapsed","minTimeDelta","lastPoint","length","minDelta","distanceTo","lineTo","segments","curveFromPoints","paths","splice","pathData","button"],"mappings":"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","sourcesContent":["import { exportImage, geometry, Group, MultiPath, Path, Image, Surface, } from '@progress/kendo-drawing';\nimport { elementOffset, limitValue } from '../common';\nvar Point = geometry.Point, Rect = geometry.Rect, transform = geometry.transform;\nvar noop = function () { };\nvar DECIMAL_DIGITS = 3;\nvar DEFAULT_COLOR = '#000';\nvar DEFAULT_BACKGROUND_COLOR = '#fff';\nvar DEFAULT_PRECISION = 1;\nvar DEFAULT_SAMPLING_RATE = 200; // Updates per second\nvar DEFAULT_STROKE_WIDTH = 1;\nvar DEFAULT_WIDTH = 750;\nvar DEFAULT_HEIGHT = 250;\nvar DEFAULT_SCALE = 1;\n// Export images at maximized scale (3x) and 2x pixel density to cover HiDPI screens.\nvar DEFAULT_EXPORT_SCALE = 6;\nvar SignaturePad = /** @class */ (function () {\n    function SignaturePad(element, options) {\n        if (options === void 0) { options = {}; }\n        this.element = element;\n        this.lastMoveTime = 0;\n        this.options = Object.assign({\n            scale: DEFAULT_SCALE,\n            precision: DEFAULT_PRECISION,\n            samplingRate: DEFAULT_SAMPLING_RATE,\n            smooth: options.smooth !== false,\n            color: options.color || DEFAULT_COLOR,\n            backgroundColor: options.backgroundColor || DEFAULT_BACKGROUND_COLOR,\n            strokeWidth: DEFAULT_STROKE_WIDTH,\n            onChange: noop,\n            onDraw: noop,\n            onDrawEnd: noop\n        }, options);\n        this.pathOptions = {\n            stroke: {\n                color: this.options.color,\n                width: this.options.strokeWidth,\n                lineCap: 'round',\n                lineJoin: 'round'\n            }\n        };\n        this.initSurface();\n        this.attachEvents();\n    }\n    SignaturePad.prototype.destroy = function () {\n        this.detachEvents();\n    };\n    SignaturePad.prototype.clear = function () {\n        this.rootGroup.clear();\n        this.path = null;\n    };\n    Object.defineProperty(SignaturePad.prototype, \"isDrawing\", {\n        get: function () {\n            return Boolean(this.points);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SignaturePad.prototype, \"pathData\", {\n        get: function () {\n            var _a;\n            return (_a = this.path) === null || _a === void 0 ? void 0 : _a.toString(DECIMAL_DIGITS);\n        },\n        set: function (value) {\n            this.clear();\n            this.path = MultiPath.parse(value, this.pathOptions);\n            this.rootGroup.append(this.path);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SignaturePad.prototype.loadImage = function (data, size) {\n        if (size === void 0) { size = []; }\n        if (!data) {\n            this.clear();\n            return;\n        }\n        var _a = this.size, width = _a[0], height = _a[1];\n        var contentWidth = width / this.options.scale;\n        var contentHeight = height / this.options.scale;\n        var importWidth = size[0] || contentWidth * DEFAULT_EXPORT_SCALE;\n        var importHeight = size[1] || contentHeight * DEFAULT_EXPORT_SCALE;\n        var scaleX = contentWidth / importWidth;\n        var scaleY = contentHeight / importHeight;\n        var scale = Math.min(scaleX, scaleY);\n        var img = new Image(data, new geometry.Rect([0, 0], [importWidth, importHeight]));\n        img.transform(transform().scale(scale, scale));\n        this.clear();\n        this.rootGroup.append(img);\n    };\n    SignaturePad.prototype.exportImage = function (options) {\n        var _a;\n        var _b = this.size, width = _b[0], height = _b[1];\n        var contentWidth = width / this.options.scale;\n        var contentHeight = height / this.options.scale;\n        var exportWidth = (options === null || options === void 0 ? void 0 : options.width) || contentWidth * DEFAULT_EXPORT_SCALE;\n        var exportHeight = (options === null || options === void 0 ? void 0 : options.height) || contentHeight * DEFAULT_EXPORT_SCALE;\n        var scaleX = exportWidth / contentWidth;\n        var scaleY = exportHeight / contentHeight;\n        var scale = Math.min(scaleX, scaleY);\n        var exportRect = new Rect([0, 0], [exportWidth, exportHeight]);\n        var exportGroup = new Group({\n            clip: Path.fromRect(exportRect)\n        });\n        var contentGroup = new Group({\n            transform: transform().scale(scale, scale)\n        });\n        var frame = Path.fromRect(exportRect, {\n            fill: {\n                color: this.options.backgroundColor\n            }\n        });\n        exportGroup.append(frame);\n        exportGroup.append(contentGroup);\n        (_a = contentGroup.children).push.apply(_a, this.rootGroup.children);\n        return exportImage(exportGroup, Object.assign({\n            width: exportWidth,\n            height: exportHeight\n        }, options));\n    };\n    SignaturePad.prototype.resize = function () {\n        this.surface.resize(true);\n    };\n    SignaturePad.prototype.setOptions = function (options) {\n        Object.assign(this.options, options);\n        this.pathOptions.stroke.color = this.options.color;\n        this.pathOptions.stroke.width = this.options.strokeWidth;\n        if (this.path) {\n            this.path.options.set('stroke.color', this.options.color);\n            this.path.options.set('stroke.width', this.options.strokeWidth);\n        }\n        this.background.options.set('fill.color', this.options.backgroundColor);\n    };\n    SignaturePad.prototype.initSurface = function () {\n        this.surface = Surface.create(this.element, { type: 'canvas' });\n        this.element.style.touchAction = 'none';\n        var scale = this.options.scale;\n        this.rootGroup = new Group({\n            transform: transform().scale(scale, scale)\n        });\n        // The signature is not resizable, store initial dimensions.\n        var width = this.element.offsetWidth || DEFAULT_WIDTH;\n        var height = this.element.offsetHeight || DEFAULT_HEIGHT;\n        this.size = [width, height];\n        this.background = Path.fromRect(new Rect([0, 0], this.size), {\n            fill: {\n                color: this.options.backgroundColor\n            }\n        });\n        this.surface.draw(this.background);\n        this.surface.draw(this.rootGroup);\n    };\n    SignaturePad.prototype.attachEvents = function () {\n        this.onPointerDown = this.onPointerDown.bind(this);\n        this.onPointerMove = this.onPointerMove.bind(this);\n        this.onPointerUp = this.onPointerUp.bind(this);\n        this.element.addEventListener('pointerdown', this.onPointerDown);\n        this.element.addEventListener('pointermove', this.onPointerMove);\n        this.element.addEventListener('pointerup', this.onPointerUp);\n    };\n    SignaturePad.prototype.detachEvents = function () {\n        this.element.removeEventListener('pointerdown', this.onPointerDown);\n        this.element.removeEventListener('pointermove', this.onPointerMove);\n        this.element.removeEventListener('pointerup', this.onPointerUp);\n    };\n    SignaturePad.prototype.touchPoint = function (e) {\n        var offset = elementOffset(this.element);\n        var pageX = e.pageX;\n        var pageY = e.pageY;\n        var scale = 1 / this.options.scale;\n        return new Point(pageX - offset.left, pageY - offset.top).scale(scale, scale);\n    };\n    SignaturePad.prototype.onPointerDown = function (e) {\n        if (this.options.readonly || !e.isPrimary || !isMainButton(e)) {\n            return;\n        }\n        if (!this.path) {\n            this.path = new MultiPath(this.pathOptions);\n            this.rootGroup.append(this.path);\n        }\n        this.options.onDraw();\n        this.element.setPointerCapture(e.pointerId);\n        var point = this.touchPoint(e);\n        this.points = [point];\n        this.path.moveTo(point);\n    };\n    SignaturePad.prototype.onPointerMove = function (e) {\n        if (!this.points || !e.isPrimary) {\n            return;\n        }\n        var now = (new Date()).getTime();\n        var elapsed = now - this.lastMoveTime;\n        var minTimeDelta = 1000 / limitValue(this.options.samplingRate, 1, 10000);\n        if (elapsed < minTimeDelta) {\n            return;\n        }\n        else {\n            this.lastMoveTime = now;\n        }\n        var point = this.touchPoint(e);\n        var lastPoint = this.points[this.points.length - 1];\n        var minDelta = 1 / limitValue(this.options.precision, 0.01, 100);\n        if (point.distanceTo(lastPoint) < minDelta) {\n            return;\n        }\n        this.points.push(point);\n        this.path.lineTo(point);\n    };\n    SignaturePad.prototype.onPointerUp = function (e) {\n        if (!e.isPrimary || !this.path || !this.points || this.options.readonly) {\n            return;\n        }\n        if (this.options.smooth) {\n            var segments = Path.curveFromPoints(this.points);\n            this.path.paths.splice(this.path.paths.length - 1, 1, segments);\n        }\n        this.points = null;\n        this.options.onDrawEnd();\n        this.options.onChange(this.pathData);\n    };\n    return SignaturePad;\n}());\nexport { SignaturePad };\nfunction isMainButton(e) {\n    return typeof (e.button) !== 'number' || e.button === 0;\n}\n"]},"metadata":{},"sourceType":"module"}