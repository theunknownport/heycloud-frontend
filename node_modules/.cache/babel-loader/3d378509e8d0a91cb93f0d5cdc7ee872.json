{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport { classNames } from '@progress/kendo-react-common';\nimport { cloneDate, getDate, isEqualDate } from '@progress/kendo-date-math';\nimport { registerForIntl, provideIntlService } from '@progress/kendo-react-intl';\nimport { Virtualization } from '../../virtualization/Virtualization';\nimport { View } from './View';\nimport { Header } from './Header';\nimport { dateInRange, getToday, isInRange, shiftWeekNames } from '../../utils';\nimport { CalendarViewEnum } from '../models';\nimport { TodayCommand } from './TodayCommand';\nvar VIEWS_COUNT = 5;\n/**\n * @hidden\n */\n\nvar ViewList =\n/** @class */\nfunction (_super) {\n  __extends(ViewList, _super);\n\n  function ViewList(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.virtualization = null;\n    _this.calendarView = null;\n    _this.table = null;\n    _this.intl = null;\n    _this.bottomOffset = 0;\n    _this.viewOffset = 0;\n    _this.viewHeight = 0;\n    _this._element = null;\n    _this.isActive = false;\n    _this.animateToIndex = true;\n    _this.shouldScroll = false;\n\n    _this.focusActiveDate = function () {\n      if (!_this._element) {\n        return;\n      }\n\n      var focusedCell = _this._element.querySelector('td.k-focus');\n\n      var nextActiveCell = _this._element.querySelector('.k-state-pending-focus');\n\n      if (focusedCell && focusedCell[0]) {\n        focusedCell[0].classList.remove('k-focus');\n      }\n\n      if (nextActiveCell) {\n        nextActiveCell.classList.add('k-focus');\n      }\n\n      _this.isActive = true;\n    };\n\n    _this.blurActiveDate = function () {\n      if (!_this._element) {\n        return;\n      }\n\n      var focusedCell = _this._element.querySelector('td.k-focus');\n\n      if (focusedCell) {\n        focusedCell.classList.remove('k-focus');\n      }\n\n      _this.isActive = false;\n    };\n\n    _this.handleVirtualizationMount = function (virtualization) {\n      _this.virtualization = virtualization;\n\n      if (_this.virtualization && _this.table) {\n        _this.table.style.transform = \"translateY(\".concat(_this.viewOffset, \"px)\");\n        var viewDate = dateInRange(_this.props.focusedDate, _this.props.min, _this.props.max);\n\n        var indexToScroll = _this.props.service.skip(viewDate, _this.props.min);\n\n        _this.virtualization.scrollToIndex(indexToScroll);\n      }\n    };\n\n    _this.buildMonthView = function (cols, weekNames) {\n      return React.createElement(\"table\", {\n        key: \"calendar-view-list-weekdays\",\n        className: \"k-calendar-table k-calendar-weekdays\"\n      }, React.createElement(\"colgroup\", null, cols.map(function (_, idx) {\n        return React.createElement(\"col\", {\n          key: idx\n        });\n      })), React.createElement(\"thead\", {\n        className: \"k-calendar-thead\"\n      }, React.createElement(\"tr\", {\n        className: \"k-calendar-tr\"\n      }, weekNames.map(function (name, idx) {\n        return React.createElement(\"th\", {\n          key: idx,\n          className: \"k-calendar-th\"\n        }, name);\n      }))));\n    };\n\n    _this.buildDates = function (cols, dates) {\n      var cellUID = _this.props.cellUID;\n      return React.createElement(\"table\", {\n        className: \"k-calendar-table\",\n        ref: function (table) {\n          return _this.table = table;\n        },\n        role: \"grid\",\n        \"aria-activedescendant\": cellUID + _this.props.focusedDate.getTime()\n      }, React.createElement(\"colgroup\", null, cols.map(function (_, idx) {\n        return React.createElement(\"col\", {\n          key: idx\n        });\n      })), dates.map(function (date) {\n        return React.createElement(View, {\n          ref: function (el) {\n            if (!_this.calendarView) {\n              _this.calendarView = el;\n            }\n          },\n          key: date.getTime(),\n          activeView: _this.props.activeView,\n          viewDate: date,\n          min: _this.props.min,\n          max: _this.props.max,\n          cellUID: cellUID,\n          focusedDate: _this.props.focusedDate,\n          cell: _this.props.cell,\n          selectedDate: _this.props.value,\n          showWeekNumbers: _this.weekNumber,\n          onChange: _this.handleDateChange,\n          bus: _this.props.bus,\n          service: _this.props.service,\n          weekCell: _this.props.weekCell\n        });\n      }));\n    };\n\n    _this.calculateHeights = function () {\n      if (!_this.props.dom) {\n        return;\n      }\n\n      var scrollableHeight = _this.props.activeView === CalendarViewEnum.month ? _this.props.dom.scrollableContentHeight : _this.props.dom.scrollableYearContentHeight;\n      _this.bottomOffset = scrollableHeight - _this.props.dom.viewHeight(_this.props.activeView);\n      _this.viewOffset = -1 * _this.props.dom.headerHeight;\n      _this.viewHeight = _this.props.dom.viewHeight(_this.props.activeView) || 1;\n    };\n\n    _this.getTake = function (skip, total) {\n      return Math.min(total - skip, _this.take);\n    };\n\n    _this.handleScrollAction = function (_a) {\n      var index = _a.index,\n          scrollAction = _a.scrollAction,\n          pageAction = _a.pageAction;\n      var skip = pageAction ? pageAction.skip : _this.state.skip;\n\n      if (_this.state.index !== index || _this.state.skip !== skip) {\n        _this.setState({\n          index: index,\n          skip: skip\n        });\n      }\n\n      if (_this.table && scrollAction) {\n        var translate = \"translateY(\".concat(scrollAction.offset, \"px)\");\n        _this.table.style.transform = translate;\n      }\n    };\n\n    _this.handleTodayClick = function (event) {\n      _this.shouldScroll = true;\n\n      _this.handleDateChange.call(undefined, event, true);\n    };\n\n    _this.handleDateChange = function (event, isTodayClick) {\n      if (isTodayClick === void 0) {\n        isTodayClick = false;\n      }\n\n      var onChange = _this.props.onChange;\n\n      if (onChange) {\n        var args = {\n          syntheticEvent: event.syntheticEvent,\n          nativeEvent: event.nativeEvent,\n          value: cloneDate(event.value),\n          target: _this,\n          isTodayClick: isTodayClick\n        };\n        onChange.call(undefined, args);\n      }\n    };\n\n    _this.lastView = _this.props.activeView;\n    _this.lastFocus = _this.props.focusedDate;\n    _this.state = {\n      skip: _this.props.service.skip(_this.props.focusedDate, _this.props.min),\n      index: _this.props.service.skip(_this.props.focusedDate, _this.props.min)\n    };\n    return _this;\n  }\n\n  Object.defineProperty(ViewList.prototype, \"element\", {\n    get: function () {\n      return this._element;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ViewList.prototype, \"weekNames\", {\n    get: function () {\n      this.intl = provideIntlService(this);\n      var weekNames = shiftWeekNames(this.intl.dateFormatNames({\n        nameType: 'short',\n        type: 'days'\n      }), this.intl.firstDay());\n      return this.weekNumber ? [''].concat(weekNames) : weekNames;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ViewList.prototype, \"weekNumber\", {\n    get: function () {\n      return Boolean(this.props.showWeekNumbers && this.props.activeView === CalendarViewEnum.month);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ViewList.prototype, \"take\", {\n    get: function () {\n      return this.props.take !== undefined ? this.props.take : ViewList.defaultProps.take;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ViewList.prototype, \"animate\", {\n    get: function () {\n      return Boolean(this.props.smoothScroll && this.animateToIndex);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ViewList.prototype, \"todayIsInRange\", {\n    get: function () {\n      return isInRange(getToday(), getDate(this.props.min), getDate(this.props.max));\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  ViewList.prototype.componentDidUpdate = function (_prevProps, _prevState) {\n    this.shouldScroll = false;\n\n    if (this.indexToScroll !== undefined && this.virtualization) {\n      this.virtualization[this.animate ? 'animateToIndex' : 'scrollToIndex'](this.indexToScroll);\n    }\n\n    if (this.isActive) {\n      this.focusActiveDate();\n    }\n\n    this.lastView = this.props.activeView; // this.lastFocus = this.props.focusedDate;\n\n    this.indexToScroll = undefined;\n  };\n\n  ViewList.prototype.render = function () {\n    var _this = this;\n\n    this.calculateHeights();\n    var didViewChange = this.lastView !== this.props.activeView;\n    var focusedDate = dateInRange(this.props.focusedDate, this.props.min, this.props.max);\n    var skip = !didViewChange ? this.state.skip : this.props.service.skip(focusedDate, this.props.min);\n    var total = this.props.service.total(this.props.min, this.props.max);\n    var take = this.getTake(skip, total);\n    var viewDate = this.props.service.addToDate(this.props.min, skip);\n    var activeDate = this.props.service.addToDate(this.props.min, this.state.index);\n    var cols = new Array(this.props.service.rowLength(this.weekNumber)).fill('');\n    var didViewChanged = this.props.activeView !== this.lastView;\n    this.animateToIndex = !didViewChanged;\n\n    if (didViewChanged || !isEqualDate(this.lastFocus, focusedDate) || this.shouldScroll || !this.props.shouldScroll || this.props.shouldScroll()) {\n      this.indexToScroll = this.props.service.skip(focusedDate, this.props.min);\n    }\n\n    this.lastFocus = focusedDate;\n    var rootClassNames = classNames('k-calendar-view k-vstack', {\n      'k-calendar-monthview': this.props.activeView === CalendarViewEnum.month,\n      'k-calendar-yearview': this.props.activeView === CalendarViewEnum.year,\n      'k-calendar-decadeview': this.props.activeView === CalendarViewEnum.decade,\n      'k-calendar-centuryview': this.props.activeView === CalendarViewEnum.century\n    });\n    var dates = this.buildDates(cols, this.props.service.datesList(viewDate, take));\n    var viewListBody = React.createElement(React.Fragment, null, React.createElement(Header, {\n      key: \"calendar-view-list-header\",\n      currentDate: activeDate,\n      min: this.props.min,\n      max: this.props.max,\n      activeView: this.props.activeView,\n      bus: this.props.bus,\n      service: this.props.service,\n      headerTitle: this.props.headerTitle,\n      commands: React.createElement(React.Fragment, null, React.createElement(TodayCommand, {\n        min: this.props.min,\n        max: this.props.max,\n        onClick: this.handleTodayClick,\n        disabled: !this.todayIsInRange,\n        tabIndex: this.props.tabIndex\n      }))\n    }), this.props.activeView === CalendarViewEnum.month && this.buildMonthView(cols, this.weekNames), React.createElement(Virtualization, {\n      key: \"calendar-view-list-content\",\n      skip: skip,\n      take: this.take,\n      total: total,\n      itemHeight: this.viewHeight,\n      topOffset: this.viewOffset,\n      bottomOffset: this.bottomOffset,\n      scrollOffsetSize: this.viewOffset,\n      maxScrollDifference: this.viewHeight,\n      onScroll: this.props.onScroll,\n      onScrollAction: this.handleScrollAction,\n      onMount: this.handleVirtualizationMount,\n      children: dates,\n      tabIndex: this.props.tabIndex\n    }));\n    return React.createElement(\"div\", {\n      ref: function (el) {\n        _this._element = el;\n      },\n      className: rootClassNames\n    }, this.props.dom.didCalculate ? viewListBody : null);\n  };\n\n  ViewList.propTypes = {\n    activeView: PropTypes.number.isRequired,\n    bottomOffset: PropTypes.number,\n    cellUID: PropTypes.string.isRequired,\n    focusedDate: PropTypes.instanceOf(Date).isRequired,\n    max: PropTypes.instanceOf(Date).isRequired,\n    min: PropTypes.instanceOf(Date).isRequired,\n    onChange: PropTypes.func,\n    showWeekNumbers: PropTypes.bool,\n    smoothScroll: PropTypes.bool,\n    take: PropTypes.number,\n    value: PropTypes.instanceOf(Date),\n    viewHeight: PropTypes.number,\n    viewOffset: PropTypes.number,\n    tabIndex: PropTypes.number\n  };\n  ViewList.defaultProps = {\n    take: VIEWS_COUNT,\n    showWeekNumbers: false,\n    smoothScroll: true\n  };\n  return ViewList;\n}(React.Component);\n\nexport { ViewList };\nregisterForIntl(ViewList);","map":{"version":3,"sources":["C:/Projects/React/heycloud-frontent-2/node_modules/@progress/kendo-react-dateinputs/dist/es/calendar/components/ViewList.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","React","PropTypes","classNames","cloneDate","getDate","isEqualDate","registerForIntl","provideIntlService","Virtualization","View","Header","dateInRange","getToday","isInRange","shiftWeekNames","CalendarViewEnum","TodayCommand","VIEWS_COUNT","ViewList","_super","props","_this","virtualization","calendarView","table","intl","bottomOffset","viewOffset","viewHeight","_element","isActive","animateToIndex","shouldScroll","focusActiveDate","focusedCell","querySelector","nextActiveCell","classList","remove","add","blurActiveDate","handleVirtualizationMount","style","transform","concat","viewDate","focusedDate","min","max","indexToScroll","service","skip","scrollToIndex","buildMonthView","cols","weekNames","createElement","key","className","map","_","idx","name","buildDates","dates","cellUID","ref","role","getTime","date","el","activeView","cell","selectedDate","value","showWeekNumbers","weekNumber","onChange","handleDateChange","bus","weekCell","calculateHeights","dom","scrollableHeight","month","scrollableContentHeight","scrollableYearContentHeight","headerHeight","getTake","total","Math","take","handleScrollAction","_a","index","scrollAction","pageAction","state","setState","translate","offset","handleTodayClick","event","undefined","isTodayClick","args","syntheticEvent","nativeEvent","target","lastView","lastFocus","defineProperty","get","enumerable","configurable","dateFormatNames","nameType","type","firstDay","Boolean","defaultProps","smoothScroll","componentDidUpdate","_prevProps","_prevState","animate","render","didViewChange","addToDate","activeDate","rowLength","fill","didViewChanged","rootClassNames","year","decade","century","datesList","viewListBody","Fragment","currentDate","headerTitle","commands","onClick","disabled","todayIsInRange","tabIndex","itemHeight","topOffset","scrollOffsetSize","maxScrollDifference","onScroll","onScrollAction","onMount","children","didCalculate","propTypes","number","isRequired","string","instanceOf","Date","func","bool","Component"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport { classNames } from '@progress/kendo-react-common';\nimport { cloneDate, getDate, isEqualDate } from '@progress/kendo-date-math';\nimport { registerForIntl, provideIntlService } from '@progress/kendo-react-intl';\nimport { Virtualization } from '../../virtualization/Virtualization';\nimport { View } from './View';\nimport { Header } from './Header';\nimport { dateInRange, getToday, isInRange, shiftWeekNames } from '../../utils';\nimport { CalendarViewEnum } from '../models';\nimport { TodayCommand } from './TodayCommand';\nvar VIEWS_COUNT = 5;\n/**\n * @hidden\n */\nvar ViewList = /** @class */ (function (_super) {\n    __extends(ViewList, _super);\n    function ViewList(props) {\n        var _this = _super.call(this, props) || this;\n        _this.virtualization = null;\n        _this.calendarView = null;\n        _this.table = null;\n        _this.intl = null;\n        _this.bottomOffset = 0;\n        _this.viewOffset = 0;\n        _this.viewHeight = 0;\n        _this._element = null;\n        _this.isActive = false;\n        _this.animateToIndex = true;\n        _this.shouldScroll = false;\n        _this.focusActiveDate = function () {\n            if (!_this._element) {\n                return;\n            }\n            var focusedCell = _this._element.querySelector('td.k-focus');\n            var nextActiveCell = _this._element.querySelector('.k-state-pending-focus');\n            if (focusedCell && focusedCell[0]) {\n                focusedCell[0].classList.remove('k-focus');\n            }\n            if (nextActiveCell) {\n                nextActiveCell.classList.add('k-focus');\n            }\n            _this.isActive = true;\n        };\n        _this.blurActiveDate = function () {\n            if (!_this._element) {\n                return;\n            }\n            var focusedCell = _this._element.querySelector('td.k-focus');\n            if (focusedCell) {\n                focusedCell.classList.remove('k-focus');\n            }\n            _this.isActive = false;\n        };\n        _this.handleVirtualizationMount = function (virtualization) {\n            _this.virtualization = virtualization;\n            if (_this.virtualization && _this.table) {\n                _this.table.style.transform = \"translateY(\".concat(_this.viewOffset, \"px)\");\n                var viewDate = dateInRange(_this.props.focusedDate, _this.props.min, _this.props.max);\n                var indexToScroll = _this.props.service.skip(viewDate, _this.props.min);\n                _this.virtualization.scrollToIndex(indexToScroll);\n            }\n        };\n        _this.buildMonthView = function (cols, weekNames) {\n            return (React.createElement(\"table\", { key: \"calendar-view-list-weekdays\", className: \"k-calendar-table k-calendar-weekdays\" },\n                React.createElement(\"colgroup\", null, cols.map(function (_, idx) { return (React.createElement(\"col\", { key: idx })); })),\n                React.createElement(\"thead\", { className: \"k-calendar-thead\" },\n                    React.createElement(\"tr\", { className: \"k-calendar-tr\" }, weekNames.map(function (name, idx) { return (React.createElement(\"th\", { key: idx, className: \"k-calendar-th\" }, name)); })))));\n        };\n        _this.buildDates = function (cols, dates) {\n            var cellUID = _this.props.cellUID;\n            return (React.createElement(\"table\", { className: \"k-calendar-table\", ref: function (table) { return _this.table = table; }, role: \"grid\", \"aria-activedescendant\": cellUID + _this.props.focusedDate.getTime() },\n                React.createElement(\"colgroup\", null, cols.map(function (_, idx) { return (React.createElement(\"col\", { key: idx })); })),\n                dates.map(function (date) { return (React.createElement(View, { ref: function (el) { if (!_this.calendarView) {\n                        _this.calendarView = el;\n                    } }, key: date.getTime(), activeView: _this.props.activeView, viewDate: date, min: _this.props.min, max: _this.props.max, cellUID: cellUID, focusedDate: _this.props.focusedDate, cell: _this.props.cell, selectedDate: _this.props.value, showWeekNumbers: _this.weekNumber, onChange: _this.handleDateChange, bus: _this.props.bus, service: _this.props.service, weekCell: _this.props.weekCell })); })));\n        };\n        _this.calculateHeights = function () {\n            if (!_this.props.dom) {\n                return;\n            }\n            var scrollableHeight = _this.props.activeView === CalendarViewEnum.month ?\n                _this.props.dom.scrollableContentHeight :\n                _this.props.dom.scrollableYearContentHeight;\n            _this.bottomOffset = scrollableHeight - _this.props.dom.viewHeight(_this.props.activeView);\n            _this.viewOffset = -1 * _this.props.dom.headerHeight;\n            _this.viewHeight = _this.props.dom.viewHeight(_this.props.activeView) || 1;\n        };\n        _this.getTake = function (skip, total) {\n            return Math.min(total - skip, _this.take);\n        };\n        _this.handleScrollAction = function (_a) {\n            var index = _a.index, scrollAction = _a.scrollAction, pageAction = _a.pageAction;\n            var skip = pageAction ? pageAction.skip : _this.state.skip;\n            if (_this.state.index !== index || _this.state.skip !== skip) {\n                _this.setState({ index: index, skip: skip });\n            }\n            if (_this.table && scrollAction) {\n                var translate = \"translateY(\".concat(scrollAction.offset, \"px)\");\n                _this.table.style.transform = translate;\n            }\n        };\n        _this.handleTodayClick = function (event) {\n            _this.shouldScroll = true;\n            _this.handleDateChange.call(undefined, event, true);\n        };\n        _this.handleDateChange = function (event, isTodayClick) {\n            if (isTodayClick === void 0) { isTodayClick = false; }\n            var onChange = _this.props.onChange;\n            if (onChange) {\n                var args = {\n                    syntheticEvent: event.syntheticEvent,\n                    nativeEvent: event.nativeEvent,\n                    value: cloneDate(event.value),\n                    target: _this,\n                    isTodayClick: isTodayClick\n                };\n                onChange.call(undefined, args);\n            }\n        };\n        _this.lastView = _this.props.activeView;\n        _this.lastFocus = _this.props.focusedDate;\n        _this.state = {\n            skip: _this.props.service.skip(_this.props.focusedDate, _this.props.min),\n            index: _this.props.service.skip(_this.props.focusedDate, _this.props.min)\n        };\n        return _this;\n    }\n    Object.defineProperty(ViewList.prototype, \"element\", {\n        get: function () {\n            return this._element;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewList.prototype, \"weekNames\", {\n        get: function () {\n            this.intl = provideIntlService(this);\n            var weekNames = shiftWeekNames(this.intl.dateFormatNames({ nameType: 'short', type: 'days' }), this.intl.firstDay());\n            return this.weekNumber ? [''].concat(weekNames) : weekNames;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewList.prototype, \"weekNumber\", {\n        get: function () {\n            return Boolean(this.props.showWeekNumbers && this.props.activeView === CalendarViewEnum.month);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewList.prototype, \"take\", {\n        get: function () {\n            return this.props.take !== undefined ? this.props.take : ViewList.defaultProps.take;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewList.prototype, \"animate\", {\n        get: function () {\n            return Boolean(this.props.smoothScroll && this.animateToIndex);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewList.prototype, \"todayIsInRange\", {\n        get: function () {\n            return isInRange(getToday(), getDate(this.props.min), getDate(this.props.max));\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ViewList.prototype.componentDidUpdate = function (_prevProps, _prevState) {\n        this.shouldScroll = false;\n        if (this.indexToScroll !== undefined && this.virtualization) {\n            this.virtualization[this.animate ? 'animateToIndex' : 'scrollToIndex'](this.indexToScroll);\n        }\n        if (this.isActive) {\n            this.focusActiveDate();\n        }\n        this.lastView = this.props.activeView;\n        // this.lastFocus = this.props.focusedDate;\n        this.indexToScroll = undefined;\n    };\n    ViewList.prototype.render = function () {\n        var _this = this;\n        this.calculateHeights();\n        var didViewChange = this.lastView !== this.props.activeView;\n        var focusedDate = dateInRange(this.props.focusedDate, this.props.min, this.props.max);\n        var skip = !didViewChange ? this.state.skip : this.props.service.skip(focusedDate, this.props.min);\n        var total = this.props.service.total(this.props.min, this.props.max);\n        var take = this.getTake(skip, total);\n        var viewDate = this.props.service.addToDate(this.props.min, skip);\n        var activeDate = this.props.service.addToDate(this.props.min, this.state.index);\n        var cols = new Array(this.props.service.rowLength(this.weekNumber)).fill('');\n        var didViewChanged = this.props.activeView !== this.lastView;\n        this.animateToIndex = !didViewChanged;\n        if (didViewChanged\n            || !isEqualDate(this.lastFocus, focusedDate)\n            || this.shouldScroll\n            || (!this.props.shouldScroll || this.props.shouldScroll())) {\n            this.indexToScroll = this.props.service.skip(focusedDate, this.props.min);\n        }\n        this.lastFocus = focusedDate;\n        var rootClassNames = classNames('k-calendar-view k-vstack', {\n            'k-calendar-monthview': this.props.activeView === CalendarViewEnum.month,\n            'k-calendar-yearview': this.props.activeView === CalendarViewEnum.year,\n            'k-calendar-decadeview': this.props.activeView === CalendarViewEnum.decade,\n            'k-calendar-centuryview': this.props.activeView === CalendarViewEnum.century\n        });\n        var dates = this.buildDates(cols, this.props.service.datesList(viewDate, take));\n        var viewListBody = (React.createElement(React.Fragment, null,\n            React.createElement(Header, { key: \"calendar-view-list-header\", currentDate: activeDate, min: this.props.min, max: this.props.max, activeView: this.props.activeView, bus: this.props.bus, service: this.props.service, headerTitle: this.props.headerTitle, commands: (React.createElement(React.Fragment, null,\n                    React.createElement(TodayCommand, { min: this.props.min, max: this.props.max, onClick: this.handleTodayClick, disabled: !this.todayIsInRange, tabIndex: this.props.tabIndex }))) }),\n            this.props.activeView === CalendarViewEnum.month && this.buildMonthView(cols, this.weekNames),\n            React.createElement(Virtualization, { key: \"calendar-view-list-content\", skip: skip, take: this.take, total: total, itemHeight: this.viewHeight, topOffset: this.viewOffset, bottomOffset: this.bottomOffset, scrollOffsetSize: this.viewOffset, maxScrollDifference: this.viewHeight, onScroll: this.props.onScroll, onScrollAction: this.handleScrollAction, onMount: this.handleVirtualizationMount, children: dates, tabIndex: this.props.tabIndex })));\n        return (React.createElement(\"div\", { ref: function (el) { _this._element = el; }, className: rootClassNames }, this.props.dom.didCalculate ? viewListBody : null));\n    };\n    ViewList.propTypes = {\n        activeView: PropTypes.number.isRequired,\n        bottomOffset: PropTypes.number,\n        cellUID: PropTypes.string.isRequired,\n        focusedDate: PropTypes.instanceOf(Date).isRequired,\n        max: PropTypes.instanceOf(Date).isRequired,\n        min: PropTypes.instanceOf(Date).isRequired,\n        onChange: PropTypes.func,\n        showWeekNumbers: PropTypes.bool,\n        smoothScroll: PropTypes.bool,\n        take: PropTypes.number,\n        value: PropTypes.instanceOf(Date),\n        viewHeight: PropTypes.number,\n        viewOffset: PropTypes.number,\n        tabIndex: PropTypes.number\n    };\n    ViewList.defaultProps = {\n        take: VIEWS_COUNT,\n        showWeekNumbers: false,\n        smoothScroll: true\n    };\n    return ViewList;\n}(React.Component));\nexport { ViewList };\nregisterForIntl(ViewList);\n"]},"metadata":{},"sourceType":"module"}