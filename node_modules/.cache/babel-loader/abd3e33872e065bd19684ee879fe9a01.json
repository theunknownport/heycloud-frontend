{"ast":null,"code":"var __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nimport { guid, Keys } from '@progress/kendo-react-common';\nimport { findId, findNextIdByCellIndex, findNextIdByRowIndex, getBodyElement, getHeaderElement, getNavigatableId, tableKeyboardNavigationTools as navigationTools } from './utils';\n/**\n * @hidden\n */\n\nvar onConstructor = function (options) {\n  var navigatable = options.navigatable,\n      contextStateRef = options.contextStateRef,\n      navigationStateRef = options.navigationStateRef,\n      idPrefix = options.idPrefix; // v.2: check if nested navigation\n\n  if (navigatable) {\n    contextStateRef.current = {\n      activeId: '',\n      level: 0\n    };\n    navigationStateRef.current = {\n      activeElementIsFocused: false,\n      prevNavigationIndexes: undefined,\n      idPrefix: idPrefix || guid(),\n      navigationMatrix: [],\n      lastHeaderIndex: -1\n    };\n  }\n};\n/**\n * @hidden\n */\n\n\nvar onComponentDidMount = function (options) {\n  var scope = options.scope,\n      contextStateRef = options.contextStateRef,\n      navigationStateRef = options.navigationStateRef;\n\n  if (contextStateRef.current && navigationStateRef.current && scope) {\n    generateMatrix(options);\n    var firstId = navigationStateRef.current.navigationMatrix[0][0];\n    var firstIdElement = navigationTools.getActiveElement(scope, firstId);\n\n    if (firstId && firstIdElement) {\n      contextStateRef.current.activeId = firstId;\n      firstIdElement.setAttribute('tabIndex', '0');\n    }\n  }\n};\n/**\n * @hidden\n */\n\n\nvar onGetSnapshotBeforeUpdate = function (options) {\n  var contextStateRef = options.contextStateRef,\n      navigationStateRef = options.navigationStateRef,\n      currentDocument = options.document;\n\n  if (contextStateRef.current && navigationStateRef.current && currentDocument) {\n    var activeElement = currentDocument.activeElement;\n    var activeId = navigationTools.getNavigatableId(activeElement);\n\n    if (activeId && activeId === contextStateRef.current.activeId) {\n      navigationStateRef.current.activeElementIsFocused = true;\n    }\n  }\n};\n/**\n * @hidden\n */\n\n\nvar onComponentDidUpdate = function (options) {\n  var scope = options.scope,\n      contextStateRef = options.contextStateRef,\n      navigationStateRef = options.navigationStateRef;\n  generateMatrix(options); // check if nested navigation\n\n  if (contextStateRef.current && navigationStateRef.current && scope) {\n    var activeElement = navigationTools.getActiveElement(scope, contextStateRef.current.activeId);\n\n    if (!activeElement) {\n      var firstId = navigationStateRef.current.navigationMatrix[0][0];\n      var firstIdElement = navigationTools.getActiveElement(scope, firstId);\n\n      if (firstId && firstIdElement) {\n        contextStateRef.current.activeId = firstId;\n        firstIdElement.setAttribute('tabIndex', '0');\n\n        if (navigationStateRef.current.activeElementIsFocused) {\n          firstIdElement.focus();\n        }\n      }\n    }\n\n    navigationStateRef.current.activeElementIsFocused = false;\n  }\n};\n/**\n * @hidden\n */\n\n\nvar onFocus = function (event, options) {\n  var contextStateRef = options.contextStateRef;\n\n  if (event.isDefaultPrevented()) {\n    return;\n  }\n\n  if (!contextStateRef.current) {\n    return;\n  }\n\n  var focusedElement = event.target;\n  var activeId = navigationTools.getNavigatableId(focusedElement);\n\n  if (activeId && activeId !== contextStateRef.current.activeId) {\n    var scope = navigationTools.getClosestScope(focusedElement);\n\n    if (!scope) {\n      return;\n    }\n\n    var prevElement = navigationTools.getActiveElement(scope, contextStateRef.current.activeId);\n\n    if (prevElement) {\n      prevElement.setAttribute('tabIndex', '-1');\n    }\n\n    focusedElement.setAttribute('tabIndex', '0');\n    contextStateRef.current.activeId = activeId;\n  }\n};\n/**\n * @hidden\n */\n\n\nvar onKeyDown = function (event, options) {\n  var contextStateRef = options.contextStateRef,\n      navigationStateRef = options.navigationStateRef,\n      onNavigationAction = options.onNavigationAction;\n\n  if (event.isDefaultPrevented()) {\n    return;\n  }\n\n  if (!contextStateRef.current || !navigationStateRef.current) {\n    return;\n  }\n\n  if (event.keyCode === Keys.esc) {\n    // activate navigation\n    var elementForFocus = navigationTools.getClosestNavigatableElement(event.target);\n    navigationTools.focusElement({\n      elementForFocus: elementForFocus,\n      event: event,\n      contextStateRef: contextStateRef\n    });\n    return;\n  }\n\n  var element = event.target;\n  var elementId = navigationTools.getNavigatableId(element);\n  var dataLevel = navigationTools.getNavigatableLevel(element);\n  var scope = navigationTools.getClosestScope(element);\n  var matrix = navigationStateRef.current.navigationMatrix;\n\n  if (dataLevel !== undefined && scope) {\n    if (event.keyCode === Keys.enter) {\n      // activate nested navigation or focus focusable element\n      var navigatableElement = navigationTools.getNavigatableElement(element, {\n        level: dataLevel + 1\n      });\n\n      if (navigatableElement) {\n        navigationTools.focusElement({\n          elementForFocus: navigatableElement,\n          event: event,\n          contextStateRef: contextStateRef,\n          prevElement: element\n        });\n        return;\n      } else {\n        var elementForFocus = navigationTools.getFocusableElements(element)[0];\n        navigationTools.focusElement({\n          elementForFocus: elementForFocus,\n          event: event,\n          contextStateRef: contextStateRef,\n          prevElement: element\n        });\n        return;\n      }\n    }\n\n    if (event.keyCode === Keys.up || event.keyCode === Keys.down || event.keyCode === Keys.left || event.keyCode === Keys.right) {\n      var isReverse = event.keyCode === Keys.up || event.keyCode === Keys.left;\n      var isVertical = event.keyCode === Keys.up || event.keyCode === Keys.down;\n      var currentIdIndexes = void 0;\n\n      if (navigationStateRef.current && navigationStateRef.current.prevNavigationIndexes) {\n        var _a = navigationStateRef.current.prevNavigationIndexes,\n            rowIndex = _a[0],\n            cellIndex = _a[1];\n\n        if (matrix[rowIndex][cellIndex] === elementId) {\n          currentIdIndexes = navigationStateRef.current.prevNavigationIndexes;\n        } else {\n          currentIdIndexes = findId(matrix, elementId);\n        }\n      } else {\n        currentIdIndexes = findId(matrix, elementId);\n      }\n\n      if (currentIdIndexes) {\n        var rowIndex = currentIdIndexes[0],\n            cellIndex = currentIdIndexes[1];\n\n        var _b = isVertical ? findNextIdByRowIndex(rowIndex, cellIndex, elementId, matrix, isReverse) : findNextIdByCellIndex(rowIndex, cellIndex, elementId, matrix, isReverse),\n            idForFocus = _b[0],\n            currentIndexes = _b[1];\n\n        if (idForFocus) {\n          var elementForFocus = navigationTools.getActiveElement(scope, idForFocus); // emit event\n\n          navigationTools.focusElement({\n            elementForFocus: elementForFocus,\n            event: event,\n            contextStateRef: contextStateRef,\n            prevElement: element\n          });\n          navigationStateRef.current.prevNavigationIndexes = currentIndexes;\n\n          if (onNavigationAction) {\n            onNavigationAction({\n              focusElement: elementForFocus,\n              event: event\n            });\n          }\n        }\n      }\n    }\n  }\n};\n/**\n * @hidden\n */\n\n\nvar generateMatrix = function (options) {\n  var navigationStateRef = options.navigationStateRef,\n      scope = options.scope;\n\n  if (!navigationStateRef.current || !scope) {\n    return;\n  }\n\n  var matrix = [];\n  var thead = getHeaderElement(scope);\n  var tbody = getBodyElement(scope);\n\n  if (!thead || !tbody) {\n    return;\n  }\n\n  var headerRows = Array.from(thead.children);\n  var bodyRows = Array.from(tbody.children);\n\n  __spreadArray(__spreadArray([], headerRows, true), bodyRows, true).forEach(function (row, rowIndex) {\n    Array.from(row.children).forEach(function (cell) {\n      var cellId = getNavigatableId(cell);\n\n      if (!cellId) {\n        return;\n      } // cell is not navigatable\n\n\n      var rowSpan = cell.rowSpan || 1;\n      var cellSpan = cell.colSpan || 1;\n      var cellIndex;\n\n      for (var depth = rowIndex, maxDepth = rowIndex + rowSpan; depth < maxDepth; depth++) {\n        if (!matrix[depth]) {\n          matrix[depth] = [];\n        }\n\n        if (cellIndex === undefined) {\n          var freeSlotIndex = matrix[depth].findIndex(function (mi) {\n            return !mi;\n          });\n          cellIndex = freeSlotIndex > -1 ? freeSlotIndex : matrix[depth].length;\n        }\n\n        matrix[depth][cellIndex] = cellId || '';\n      }\n\n      for (var depth = cellIndex + 1, maxDepth = cellIndex + cellSpan; depth < maxDepth; depth++) {\n        matrix[rowIndex][depth] = cellId || '';\n      }\n    });\n  });\n\n  navigationStateRef.current.navigationMatrix = matrix.filter(function (row) {\n    return !!row;\n  });\n  navigationStateRef.current.lastHeaderIndex = headerRows.length - 1;\n};\n/**\n * @hidden\n */\n\n\nexport var tableKeyboardNavigation = {\n  onConstructor: onConstructor,\n  onComponentDidMount: onComponentDidMount,\n  onGetSnapshotBeforeUpdate: onGetSnapshotBeforeUpdate,\n  onComponentDidUpdate: onComponentDidUpdate,\n  onFocus: onFocus,\n  onKeyDown: onKeyDown,\n  generateMatrix: generateMatrix\n};","map":{"version":3,"sources":["C:/Projects/React/heycloud-frontent-2/node_modules/@progress/kendo-react-data-tools/dist/es/navigation/TableKeyboardNavigation.js"],"names":["__spreadArray","to","from","pack","arguments","length","i","l","ar","Array","prototype","slice","call","concat","guid","Keys","findId","findNextIdByCellIndex","findNextIdByRowIndex","getBodyElement","getHeaderElement","getNavigatableId","tableKeyboardNavigationTools","navigationTools","onConstructor","options","navigatable","contextStateRef","navigationStateRef","idPrefix","current","activeId","level","activeElementIsFocused","prevNavigationIndexes","undefined","navigationMatrix","lastHeaderIndex","onComponentDidMount","scope","generateMatrix","firstId","firstIdElement","getActiveElement","setAttribute","onGetSnapshotBeforeUpdate","currentDocument","document","activeElement","onComponentDidUpdate","focus","onFocus","event","isDefaultPrevented","focusedElement","target","getClosestScope","prevElement","onKeyDown","onNavigationAction","keyCode","esc","elementForFocus","getClosestNavigatableElement","focusElement","element","elementId","dataLevel","getNavigatableLevel","matrix","enter","navigatableElement","getNavigatableElement","getFocusableElements","up","down","left","right","isReverse","isVertical","currentIdIndexes","_a","rowIndex","cellIndex","_b","idForFocus","currentIndexes","thead","tbody","headerRows","children","bodyRows","forEach","row","cell","cellId","rowSpan","cellSpan","colSpan","depth","maxDepth","freeSlotIndex","findIndex","mi","filter","tableKeyboardNavigation"],"mappings":"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","sourcesContent":["var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { guid, Keys } from '@progress/kendo-react-common';\nimport { findId, findNextIdByCellIndex, findNextIdByRowIndex, getBodyElement, getHeaderElement, getNavigatableId, tableKeyboardNavigationTools as navigationTools } from './utils';\n/**\n * @hidden\n */\nvar onConstructor = function (options) {\n    var navigatable = options.navigatable, contextStateRef = options.contextStateRef, navigationStateRef = options.navigationStateRef, idPrefix = options.idPrefix;\n    // v.2: check if nested navigation\n    if (navigatable) {\n        contextStateRef.current = {\n            activeId: '',\n            level: 0\n        };\n        navigationStateRef.current = {\n            activeElementIsFocused: false,\n            prevNavigationIndexes: undefined,\n            idPrefix: idPrefix || guid(),\n            navigationMatrix: [],\n            lastHeaderIndex: -1\n        };\n    }\n};\n/**\n * @hidden\n */\nvar onComponentDidMount = function (options) {\n    var scope = options.scope, contextStateRef = options.contextStateRef, navigationStateRef = options.navigationStateRef;\n    if (contextStateRef.current && navigationStateRef.current && scope) {\n        generateMatrix(options);\n        var firstId = navigationStateRef.current.navigationMatrix[0][0];\n        var firstIdElement = navigationTools.getActiveElement(scope, firstId);\n        if (firstId && firstIdElement) {\n            contextStateRef.current.activeId = firstId;\n            firstIdElement.setAttribute('tabIndex', '0');\n        }\n    }\n};\n/**\n * @hidden\n */\nvar onGetSnapshotBeforeUpdate = function (options) {\n    var contextStateRef = options.contextStateRef, navigationStateRef = options.navigationStateRef, currentDocument = options.document;\n    if (contextStateRef.current && navigationStateRef.current && currentDocument) {\n        var activeElement = currentDocument.activeElement;\n        var activeId = navigationTools.getNavigatableId(activeElement);\n        if (activeId && activeId === contextStateRef.current.activeId) {\n            navigationStateRef.current.activeElementIsFocused = true;\n        }\n    }\n};\n/**\n * @hidden\n */\nvar onComponentDidUpdate = function (options) {\n    var scope = options.scope, contextStateRef = options.contextStateRef, navigationStateRef = options.navigationStateRef;\n    generateMatrix(options);\n    // check if nested navigation\n    if (contextStateRef.current && navigationStateRef.current && scope) {\n        var activeElement = navigationTools.getActiveElement(scope, contextStateRef.current.activeId);\n        if (!activeElement) {\n            var firstId = navigationStateRef.current.navigationMatrix[0][0];\n            var firstIdElement = navigationTools.getActiveElement(scope, firstId);\n            if (firstId && firstIdElement) {\n                contextStateRef.current.activeId = firstId;\n                firstIdElement.setAttribute('tabIndex', '0');\n                if (navigationStateRef.current.activeElementIsFocused) {\n                    firstIdElement.focus();\n                }\n            }\n        }\n        navigationStateRef.current.activeElementIsFocused = false;\n    }\n};\n/**\n * @hidden\n */\nvar onFocus = function (event, options) {\n    var contextStateRef = options.contextStateRef;\n    if (event.isDefaultPrevented()) {\n        return;\n    }\n    if (!contextStateRef.current) {\n        return;\n    }\n    var focusedElement = event.target;\n    var activeId = navigationTools.getNavigatableId(focusedElement);\n    if (activeId && activeId !== contextStateRef.current.activeId) {\n        var scope = navigationTools.getClosestScope(focusedElement);\n        if (!scope) {\n            return;\n        }\n        var prevElement = navigationTools.getActiveElement(scope, contextStateRef.current.activeId);\n        if (prevElement) {\n            prevElement.setAttribute('tabIndex', '-1');\n        }\n        focusedElement.setAttribute('tabIndex', '0');\n        contextStateRef.current.activeId = activeId;\n    }\n};\n/**\n * @hidden\n */\nvar onKeyDown = function (event, options) {\n    var contextStateRef = options.contextStateRef, navigationStateRef = options.navigationStateRef, onNavigationAction = options.onNavigationAction;\n    if (event.isDefaultPrevented()) {\n        return;\n    }\n    if (!contextStateRef.current || !navigationStateRef.current) {\n        return;\n    }\n    if (event.keyCode === Keys.esc) {\n        // activate navigation\n        var elementForFocus = navigationTools.getClosestNavigatableElement(event.target);\n        navigationTools.focusElement({ elementForFocus: elementForFocus, event: event, contextStateRef: contextStateRef });\n        return;\n    }\n    var element = event.target;\n    var elementId = navigationTools.getNavigatableId(element);\n    var dataLevel = navigationTools.getNavigatableLevel(element);\n    var scope = navigationTools.getClosestScope(element);\n    var matrix = navigationStateRef.current.navigationMatrix;\n    if (dataLevel !== undefined && scope) {\n        if (event.keyCode === Keys.enter) {\n            // activate nested navigation or focus focusable element\n            var navigatableElement = navigationTools.getNavigatableElement(element, { level: dataLevel + 1 });\n            if (navigatableElement) {\n                navigationTools.focusElement({\n                    elementForFocus: navigatableElement,\n                    event: event,\n                    contextStateRef: contextStateRef,\n                    prevElement: element\n                });\n                return;\n            }\n            else {\n                var elementForFocus = navigationTools.getFocusableElements(element)[0];\n                navigationTools.focusElement({ elementForFocus: elementForFocus, event: event, contextStateRef: contextStateRef, prevElement: element });\n                return;\n            }\n        }\n        if (event.keyCode === Keys.up ||\n            event.keyCode === Keys.down ||\n            event.keyCode === Keys.left ||\n            event.keyCode === Keys.right) {\n            var isReverse = event.keyCode === Keys.up || event.keyCode === Keys.left;\n            var isVertical = event.keyCode === Keys.up || event.keyCode === Keys.down;\n            var currentIdIndexes = void 0;\n            if (navigationStateRef.current && navigationStateRef.current.prevNavigationIndexes) {\n                var _a = navigationStateRef.current.prevNavigationIndexes, rowIndex = _a[0], cellIndex = _a[1];\n                if (matrix[rowIndex][cellIndex] === elementId) {\n                    currentIdIndexes = navigationStateRef.current.prevNavigationIndexes;\n                }\n                else {\n                    currentIdIndexes = findId(matrix, elementId);\n                }\n            }\n            else {\n                currentIdIndexes = findId(matrix, elementId);\n            }\n            if (currentIdIndexes) {\n                var rowIndex = currentIdIndexes[0], cellIndex = currentIdIndexes[1];\n                var _b = isVertical ?\n                    findNextIdByRowIndex(rowIndex, cellIndex, elementId, matrix, isReverse) :\n                    findNextIdByCellIndex(rowIndex, cellIndex, elementId, matrix, isReverse), idForFocus = _b[0], currentIndexes = _b[1];\n                if (idForFocus) {\n                    var elementForFocus = navigationTools.getActiveElement(scope, idForFocus);\n                    // emit event\n                    navigationTools.focusElement({ elementForFocus: elementForFocus, event: event, contextStateRef: contextStateRef, prevElement: element });\n                    navigationStateRef.current.prevNavigationIndexes = currentIndexes;\n                    if (onNavigationAction) {\n                        onNavigationAction({ focusElement: elementForFocus, event: event });\n                    }\n                }\n            }\n        }\n    }\n};\n/**\n * @hidden\n */\nvar generateMatrix = function (options) {\n    var navigationStateRef = options.navigationStateRef, scope = options.scope;\n    if (!navigationStateRef.current || !scope) {\n        return;\n    }\n    var matrix = [];\n    var thead = getHeaderElement(scope);\n    var tbody = getBodyElement(scope);\n    if (!thead || !tbody) {\n        return;\n    }\n    var headerRows = Array.from(thead.children);\n    var bodyRows = Array.from(tbody.children);\n    __spreadArray(__spreadArray([], headerRows, true), bodyRows, true).forEach(function (row, rowIndex) {\n        Array.from(row.children).forEach(function (cell) {\n            var cellId = getNavigatableId(cell);\n            if (!cellId) {\n                return;\n            } // cell is not navigatable\n            var rowSpan = cell.rowSpan || 1;\n            var cellSpan = cell.colSpan || 1;\n            var cellIndex;\n            for (var depth = rowIndex, maxDepth = rowIndex + rowSpan; depth < maxDepth; depth++) {\n                if (!matrix[depth]) {\n                    matrix[depth] = [];\n                }\n                if (cellIndex === undefined) {\n                    var freeSlotIndex = matrix[depth].findIndex(function (mi) { return !mi; });\n                    cellIndex = freeSlotIndex > -1 ? freeSlotIndex : matrix[depth].length;\n                }\n                matrix[depth][cellIndex] = cellId || '';\n            }\n            for (var depth = cellIndex + 1, maxDepth = cellIndex + cellSpan; depth < maxDepth; depth++) {\n                matrix[rowIndex][depth] = cellId || '';\n            }\n        });\n    });\n    navigationStateRef.current.navigationMatrix = matrix.filter(function (row) { return !!row; });\n    navigationStateRef.current.lastHeaderIndex = headerRows.length - 1;\n};\n/**\n * @hidden\n */\nexport var tableKeyboardNavigation = {\n    onConstructor: onConstructor,\n    onComponentDidMount: onComponentDidMount,\n    onGetSnapshotBeforeUpdate: onGetSnapshotBeforeUpdate,\n    onComponentDidUpdate: onComponentDidUpdate,\n    onFocus: onFocus,\n    onKeyDown: onKeyDown,\n    generateMatrix: generateMatrix\n};\n"]},"metadata":{},"sourceType":"module"}