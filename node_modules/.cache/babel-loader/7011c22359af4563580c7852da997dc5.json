{"ast":null,"code":"import { HttpRequest, objectEntries } from '@datadog/browser-core';\nexport var SEND_BEACON_BYTE_LENGTH_LIMIT = 60000;\nexport function send(endpointBuilder, data, meta, rawSegmentSize, flushReason) {\n  var formData = new FormData();\n  formData.set('segment', new Blob([data], {\n    type: 'application/octet-stream'\n  }), meta.session.id + \"-\" + meta.start);\n  toFormEntries(meta, function (key, value) {\n    return formData.set(key, value);\n  });\n  formData.set('raw_segment_size', rawSegmentSize.toString());\n  var request = new HttpRequest(endpointBuilder, SEND_BEACON_BYTE_LENGTH_LIMIT);\n  request.send(formData, data.byteLength, flushReason);\n}\nexport function toFormEntries(input, onEntry, prefix) {\n  if (prefix === void 0) {\n    prefix = '';\n  }\n\n  objectEntries(input).forEach(function (_a) {\n    var key = _a[0],\n        value = _a[1];\n\n    if (typeof value === 'object' && value !== null) {\n      toFormEntries(value, onEntry, \"\" + prefix + key + \".\");\n    } else {\n      onEntry(\"\" + prefix + key, String(value));\n    }\n  });\n}","map":{"version":3,"sources":["../../src/transport/send.ts"],"names":[],"mappings":"AAAA,SAAS,WAAT,EAAsB,aAAtB,QAA4D,uBAA5D;AAGA,OAAO,IAAM,6BAA6B,GAAG,KAAtC;AAEP,OAAM,SAAU,IAAV,CACJ,eADI,EAEJ,IAFI,EAGJ,IAHI,EAIJ,cAJI,EAKJ,WALI,EAKgB;AAEpB,MAAM,QAAQ,GAAG,IAAI,QAAJ,EAAjB;AAEA,EAAA,QAAQ,CAAC,GAAT,CACE,SADF,EAEE,IAAI,IAAJ,CAAS,CAAC,IAAD,CAAT,EAAiB;AACf,IAAA,IAAI,EAAE;AADS,GAAjB,CAFF,EAKK,IAAI,CAAC,OAAL,CAAa,EAAb,GAAe,GAAf,GAAmB,IAAI,CAAC,KAL7B;AAQA,EAAA,aAAa,CAAC,IAAD,EAAO,UAAC,GAAD,EAAM,KAAN,EAAW;AAAK,WAAA,QAAQ,CAAC,GAAT,CAAa,GAAb,EAAA,KAAA,CAAA;AAAwB,GAA/C,CAAb;AACA,EAAA,QAAQ,CAAC,GAAT,CAAa,kBAAb,EAAiC,cAAc,CAAC,QAAf,EAAjC;AAEA,MAAM,OAAO,GAAG,IAAI,WAAJ,CAAgB,eAAhB,EAAiC,6BAAjC,CAAhB;AACA,EAAA,OAAO,CAAC,IAAR,CAAa,QAAb,EAAuB,IAAI,CAAC,UAA5B,EAAwC,WAAxC;AACD;AAED,OAAM,SAAU,aAAV,CAAwB,KAAxB,EAAuC,OAAvC,EAAsF,MAAtF,EAAiG;AAAX,MAAA,MAAA,KAAA,KAAA,CAAA,EAAA;AAAA,IAAA,MAAA,GAAA,EAAA;AAAW;;AACrG,EAAA,aAAa,CAAC,KAAD,CAAb,CAAmD,OAAnD,CAA2D,UAAC,EAAD,EAAa;QAAX,GAAG,GAAA,EAAA,CAAA,CAAA,C;QAAE,KAAK,GAAA,EAAA,CAAA,CAAA,C;;AACrE,QAAI,OAAO,KAAP,KAAiB,QAAjB,IAA6B,KAAK,KAAK,IAA3C,EAAiD;AAC/C,MAAA,aAAa,CAAC,KAAD,EAAQ,OAAR,EAAiB,KAAG,MAAH,GAAY,GAAZ,GAAe,GAAhC,CAAb;AACD,KAFD,MAEO;AACL,MAAA,OAAO,CAAC,KAAG,MAAH,GAAY,GAAb,EAAoB,MAAM,CAAC,KAAD,CAA1B,CAAP;AACD;AACF,GAND;AAOD","sourceRoot":"","sourcesContent":["import { HttpRequest, objectEntries } from '@datadog/browser-core';\nexport var SEND_BEACON_BYTE_LENGTH_LIMIT = 60000;\nexport function send(endpointBuilder, data, meta, rawSegmentSize, flushReason) {\n    var formData = new FormData();\n    formData.set('segment', new Blob([data], {\n        type: 'application/octet-stream',\n    }), meta.session.id + \"-\" + meta.start);\n    toFormEntries(meta, function (key, value) { return formData.set(key, value); });\n    formData.set('raw_segment_size', rawSegmentSize.toString());\n    var request = new HttpRequest(endpointBuilder, SEND_BEACON_BYTE_LENGTH_LIMIT);\n    request.send(formData, data.byteLength, flushReason);\n}\nexport function toFormEntries(input, onEntry, prefix) {\n    if (prefix === void 0) { prefix = ''; }\n    objectEntries(input).forEach(function (_a) {\n        var key = _a[0], value = _a[1];\n        if (typeof value === 'object' && value !== null) {\n            toFormEntries(value, onEntry, \"\" + prefix + key + \".\");\n        }\n        else {\n            onEntry(\"\" + prefix + key, String(value));\n        }\n    });\n}\n//# sourceMappingURL=send.js.map"]},"metadata":{},"sourceType":"module"}