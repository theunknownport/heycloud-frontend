{"ast":null,"code":"import { getIndex } from './../header/';\n/**\n * @hidden\n */\n\nvar CommonDragLogic =\n/** @class */\nfunction () {\n  function CommonDragLogic(columnReorder, groupReorder, columnToGroup) {\n    var _this = this;\n\n    this.columns = [];\n    this.reorderable = false;\n    this.groupable = false;\n    this.startColumn = -1;\n    this.startGroup = -1;\n    this.currentColumn = -1;\n    this.currentGroup = -1;\n    this.dropElementClue = null;\n    this.dragElementClue = null;\n    this.groupPanelDivElement = null;\n\n    this.refGroupPanelDiv = function (e) {\n      _this.groupPanelDivElement = e;\n    };\n\n    this.refDropElementClue = function (e) {\n      _this.dropElementClue = e;\n    };\n\n    this.refDragElementClue = function (e) {\n      _this.dragElementClue = e;\n    };\n\n    this.pressHandler = function (event, element) {\n      if (!event.isTouch) {\n        event.originalEvent.preventDefault(); // could be related to:\n        // https://github.com/telerik/kendo-react/issues/773\n        // but it fixes drag column sorts the column\n        // the problem is that this blocks focus\n      }\n\n      var startColumn = _this.getColumnIndex(event, element);\n\n      _this.startGroup = _this.getGroupIndex(event);\n\n      if (startColumn >= 0) {\n        var col = _this.columns[startColumn];\n\n        if (col.reorderable && _this.reorderable || col.groupable && _this.groupable) {\n          _this.startColumn = startColumn;\n        }\n      }\n    };\n\n    this.dragHandler = function (event, element) {\n      if (!event.isTouch) {\n        event.originalEvent.preventDefault();\n      }\n\n      event.originalEvent.stopPropagation();\n\n      if (_this.startColumn === -1 && _this.startGroup === -1) {\n        return;\n      }\n\n      _this.currentColumn = _this.getColumnIndex(event, element);\n      _this.currentGroup = _this.getGroupIndex(event);\n\n      if (_this.groupPanelDivElement && _this.startGroup >= 0) {\n        _this.currentGroup = Math.min(_this.currentGroup, _this.groupPanelDivElement.children.length - 2);\n      }\n\n      var invalidIndex = !_this.isValid();\n\n      if (invalidIndex) {\n        _this.currentColumn = -1;\n        _this.currentGroup = -1;\n      }\n\n      var targetElement = _this.currentColumn >= 0 ? element.children[_this.columns[_this.currentColumn].index] : _this.groupPanelDivElement && _this.groupPanelDivElement.children[_this.currentGroup];\n\n      _this.updateDragElementClue(event, element, targetElement, invalidIndex);\n\n      _this.updateDropElementClue(event, element, targetElement, invalidIndex);\n    };\n\n    this.releaseHandler = function (event) {\n      var prevColumnIndex = _this.startColumn;\n      var nextColumnIndex = _this.currentColumn;\n      var prevGroupIndex = _this.startGroup;\n      var nextGroupIndex = _this.currentGroup;\n\n      if (_this.dropElementClue) {\n        _this.dropElementClue.setState({\n          visible: false\n        });\n      }\n\n      if (_this.dragElementClue) {\n        _this.dragElementClue.setState({\n          visible: false\n        });\n      }\n\n      var isValid = _this.isValid();\n\n      _this.startColumn = _this.startGroup = _this.currentColumn = _this.currentGroup = -1;\n\n      if (!isValid) {\n        return;\n      }\n\n      if (prevColumnIndex >= 0 && nextColumnIndex >= 0) {\n        _this.columnReorder(prevColumnIndex, nextColumnIndex, event.originalEvent);\n      } else if (prevGroupIndex >= 0 && nextGroupIndex >= 0) {\n        _this.groupReorder(prevGroupIndex, nextGroupIndex, event.originalEvent);\n      } else if (prevColumnIndex >= 0 && nextGroupIndex >= 0) {\n        _this.columnToGroup(prevColumnIndex, nextGroupIndex, event.originalEvent);\n      }\n    };\n\n    this.columnReorder = columnReorder;\n    this.groupReorder = groupReorder;\n    this.columnToGroup = columnToGroup;\n  }\n\n  CommonDragLogic.prototype.getColumnIndex = function (event, parent) {\n    if (!parent || parent.parentElement === this.groupPanelDivElement) {\n      return -1;\n    }\n\n    var index = getIndex(event, parent);\n\n    if (index === -1) {\n      return -1;\n    }\n\n    var _loop_1 = function (i) {\n      if (parent.parentNode.children[i] === parent) {\n        return {\n          value: this_1.columns.findIndex(function (c) {\n            return c.index === index && c.depth === i;\n          })\n        };\n      }\n    };\n\n    var this_1 = this;\n\n    for (var i = 0; i < parent.parentNode.children.length; i++) {\n      var state_1 = _loop_1(i);\n\n      if (typeof state_1 === \"object\") return state_1.value;\n    }\n\n    return -1;\n  };\n\n  CommonDragLogic.prototype.getGroupIndex = function (event) {\n    return getIndex(event, this.groupPanelDivElement);\n  };\n\n  CommonDragLogic.prototype.isValid = function () {\n    if (this.startGroup >= 0) {\n      // group can be moved into group only\n      return this.currentGroup >= 0 && this.currentGroup !== this.startGroup;\n    }\n\n    if (this.startColumn === -1) {\n      return false;\n    }\n\n    if (this.currentGroup >= 0) {\n      // column to group is possible\n      return this.columns[this.startColumn].groupable === true && this.groupable === true;\n    } // reorder is possible\n\n\n    return this.reorderable === true && this.currentColumn >= 0 && this.currentColumn !== this.startColumn && this.columns[this.startColumn].reorderable === true && this.columns[this.currentColumn].parentIndex === this.columns[this.startColumn].parentIndex;\n  };\n\n  CommonDragLogic.prototype.updateDragElementClue = function (event, element, targetElement, invalidIndex) {\n    if (!this.dragElementClue) {\n      return;\n    }\n\n    var innerText = this.startColumn >= 0 ? element.children[this.columns[this.startColumn].index].innerText : element.innerText;\n    this.dragElementClue.setState({\n      visible: true,\n      top: event.pageY + 10,\n      left: event.pageX,\n      innerText: innerText,\n      status: invalidIndex || !targetElement ? 'k-i-cancel' : 'k-i-plus'\n    });\n  };\n\n  CommonDragLogic.prototype.updateDropElementClue = function (event, element, targetElement, invalidIndex) {\n    if (!this.dropElementClue) {\n      return;\n    }\n\n    if (invalidIndex || !targetElement) {\n      this.dropElementClue.setState({\n        visible: false\n      });\n      return;\n    }\n\n    var rect = targetElement.getBoundingClientRect();\n    var left = rect.left + event.pageX - event.clientX - 6;\n\n    if (this.currentColumn > this.startColumn || this.currentGroup > this.startGroup && this.startGroup !== -1) {\n      left += rect.width;\n    }\n\n    var top = rect.top + event.pageY - event.clientY;\n    this.dropElementClue.setState({\n      visible: true,\n      top: top,\n      left: left,\n      height: this.currentColumn >= 0 ? element.clientHeight : rect.height\n    });\n  };\n\n  return CommonDragLogic;\n}();\n\nexport { CommonDragLogic };","map":{"version":3,"sources":["C:/Projects/React/heycloud-frontent-2/node_modules/@progress/kendo-react-data-tools/dist/es/drag/CommonDragLogic.js"],"names":["getIndex","CommonDragLogic","columnReorder","groupReorder","columnToGroup","_this","columns","reorderable","groupable","startColumn","startGroup","currentColumn","currentGroup","dropElementClue","dragElementClue","groupPanelDivElement","refGroupPanelDiv","e","refDropElementClue","refDragElementClue","pressHandler","event","element","isTouch","originalEvent","preventDefault","getColumnIndex","getGroupIndex","col","dragHandler","stopPropagation","Math","min","children","length","invalidIndex","isValid","targetElement","index","updateDragElementClue","updateDropElementClue","releaseHandler","prevColumnIndex","nextColumnIndex","prevGroupIndex","nextGroupIndex","setState","visible","prototype","parent","parentElement","_loop_1","i","parentNode","value","this_1","findIndex","c","depth","state_1","parentIndex","innerText","top","pageY","left","pageX","status","rect","getBoundingClientRect","clientX","width","clientY","height","clientHeight"],"mappings":"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","sourcesContent":["import { getIndex } from './../header/';\n/**\n * @hidden\n */\nvar CommonDragLogic = /** @class */ (function () {\n    function CommonDragLogic(columnReorder, groupReorder, columnToGroup) {\n        var _this = this;\n        this.columns = [];\n        this.reorderable = false;\n        this.groupable = false;\n        this.startColumn = -1;\n        this.startGroup = -1;\n        this.currentColumn = -1;\n        this.currentGroup = -1;\n        this.dropElementClue = null;\n        this.dragElementClue = null;\n        this.groupPanelDivElement = null;\n        this.refGroupPanelDiv = function (e) {\n            _this.groupPanelDivElement = e;\n        };\n        this.refDropElementClue = function (e) {\n            _this.dropElementClue = e;\n        };\n        this.refDragElementClue = function (e) {\n            _this.dragElementClue = e;\n        };\n        this.pressHandler = function (event, element) {\n            if (!event.isTouch) {\n                event.originalEvent.preventDefault();\n                // could be related to:\n                // https://github.com/telerik/kendo-react/issues/773\n                // but it fixes drag column sorts the column\n                // the problem is that this blocks focus\n            }\n            var startColumn = _this.getColumnIndex(event, element);\n            _this.startGroup = _this.getGroupIndex(event);\n            if (startColumn >= 0) {\n                var col = _this.columns[startColumn];\n                if (col.reorderable && _this.reorderable || col.groupable && _this.groupable) {\n                    _this.startColumn = startColumn;\n                }\n            }\n        };\n        this.dragHandler = function (event, element) {\n            if (!event.isTouch) {\n                event.originalEvent.preventDefault();\n            }\n            event.originalEvent.stopPropagation();\n            if (_this.startColumn === -1 && _this.startGroup === -1) {\n                return;\n            }\n            _this.currentColumn = _this.getColumnIndex(event, element);\n            _this.currentGroup = _this.getGroupIndex(event);\n            if (_this.groupPanelDivElement && _this.startGroup >= 0) {\n                _this.currentGroup = Math.min(_this.currentGroup, _this.groupPanelDivElement.children.length - 2);\n            }\n            var invalidIndex = !_this.isValid();\n            if (invalidIndex) {\n                _this.currentColumn = -1;\n                _this.currentGroup = -1;\n            }\n            var targetElement = (_this.currentColumn >= 0) ?\n                element.children[_this.columns[_this.currentColumn].index] :\n                _this.groupPanelDivElement && _this.groupPanelDivElement.children[_this.currentGroup];\n            _this.updateDragElementClue(event, element, targetElement, invalidIndex);\n            _this.updateDropElementClue(event, element, targetElement, invalidIndex);\n        };\n        this.releaseHandler = function (event) {\n            var prevColumnIndex = _this.startColumn;\n            var nextColumnIndex = _this.currentColumn;\n            var prevGroupIndex = _this.startGroup;\n            var nextGroupIndex = _this.currentGroup;\n            if (_this.dropElementClue) {\n                _this.dropElementClue.setState({ visible: false });\n            }\n            if (_this.dragElementClue) {\n                _this.dragElementClue.setState({ visible: false });\n            }\n            var isValid = _this.isValid();\n            _this.startColumn = _this.startGroup = _this.currentColumn = _this.currentGroup = -1;\n            if (!isValid) {\n                return;\n            }\n            if (prevColumnIndex >= 0 && nextColumnIndex >= 0) {\n                _this.columnReorder(prevColumnIndex, nextColumnIndex, event.originalEvent);\n            }\n            else if (prevGroupIndex >= 0 && nextGroupIndex >= 0) {\n                _this.groupReorder(prevGroupIndex, nextGroupIndex, event.originalEvent);\n            }\n            else if (prevColumnIndex >= 0 && nextGroupIndex >= 0) {\n                _this.columnToGroup(prevColumnIndex, nextGroupIndex, event.originalEvent);\n            }\n        };\n        this.columnReorder = columnReorder;\n        this.groupReorder = groupReorder;\n        this.columnToGroup = columnToGroup;\n    }\n    CommonDragLogic.prototype.getColumnIndex = function (event, parent) {\n        if (!parent || (parent.parentElement === this.groupPanelDivElement)) {\n            return -1;\n        }\n        var index = getIndex(event, parent);\n        if (index === -1) {\n            return -1;\n        }\n        var _loop_1 = function (i) {\n            if (parent.parentNode.children[i] === parent) {\n                return { value: this_1.columns.findIndex(function (c) { return ((c.index === index) && (c.depth === i)); }) };\n            }\n        };\n        var this_1 = this;\n        for (var i = 0; i < parent.parentNode.children.length; i++) {\n            var state_1 = _loop_1(i);\n            if (typeof state_1 === \"object\")\n                return state_1.value;\n        }\n        return -1;\n    };\n    CommonDragLogic.prototype.getGroupIndex = function (event) {\n        return getIndex(event, this.groupPanelDivElement);\n    };\n    CommonDragLogic.prototype.isValid = function () {\n        if (this.startGroup >= 0) {\n            // group can be moved into group only\n            return this.currentGroup >= 0 && this.currentGroup !== this.startGroup;\n        }\n        if (this.startColumn === -1) {\n            return false;\n        }\n        if (this.currentGroup >= 0) {\n            // column to group is possible\n            return this.columns[this.startColumn].groupable === true && this.groupable === true;\n        }\n        // reorder is possible\n        return this.reorderable === true &&\n            this.currentColumn >= 0 &&\n            this.currentColumn !== this.startColumn &&\n            this.columns[this.startColumn].reorderable === true &&\n            this.columns[this.currentColumn].parentIndex === this.columns[this.startColumn].parentIndex;\n    };\n    CommonDragLogic.prototype.updateDragElementClue = function (event, element, targetElement, invalidIndex) {\n        if (!this.dragElementClue) {\n            return;\n        }\n        var innerText = this.startColumn >= 0 ?\n            element.children[this.columns[this.startColumn].index].innerText :\n            element.innerText;\n        this.dragElementClue.setState({\n            visible: true,\n            top: (event.pageY + 10),\n            left: event.pageX,\n            innerText: innerText,\n            status: (invalidIndex || !targetElement) ? 'k-i-cancel' : 'k-i-plus'\n        });\n    };\n    CommonDragLogic.prototype.updateDropElementClue = function (event, element, targetElement, invalidIndex) {\n        if (!this.dropElementClue) {\n            return;\n        }\n        if (invalidIndex || !targetElement) {\n            this.dropElementClue.setState({ visible: false });\n            return;\n        }\n        var rect = targetElement.getBoundingClientRect();\n        var left = rect.left + event.pageX - event.clientX - 6;\n        if (this.currentColumn > this.startColumn || this.currentGroup > this.startGroup && this.startGroup !== -1) {\n            left += rect.width;\n        }\n        var top = rect.top + event.pageY - event.clientY;\n        this.dropElementClue.setState({\n            visible: true,\n            top: top,\n            left: left,\n            height: (this.currentColumn >= 0) ? element.clientHeight : rect.height\n        });\n    };\n    return CommonDragLogic;\n}());\nexport { CommonDragLogic };\n"]},"metadata":{},"sourceType":"module"}