{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nimport * as React from 'react';\nimport { Popup } from '@progress/kendo-react-popup';\nimport { useLocalization } from '@progress/kendo-react-intl';\nimport { isCompositeFilterDescriptor } from '@progress/kendo-data-query';\nimport { ColumnMenuItem } from './ColumnMenuItem';\nimport { ColumnMenuTextFilter, ColumnMenuNumericFilter, ColumnMenuDateFilter, ColumnMenuBooleanFilter } from './ColumnMenuFilters';\nimport { ColumnMenuFilterLogic } from './ColumnMenuFilterLogic';\nimport { ColumnMenuFilterForm } from './ColumnMenuFilterForm';\nimport { messages, columnMenuFilterTitle, columnMenuSortAscending, columnMenuSortDescending } from '../messages';\nimport { validatePackage } from '@progress/kendo-react-common';\nimport { packageMetadata } from '../package-metadata';\n/** @hidden */\n\nvar ColumnMenuWrapper = function (props) {\n  validatePackage(packageMetadata);\n  var emptySort = React.useRef([]);\n  var field = props.field,\n      filter = props.filter,\n      _a = props.sort,\n      sort = _a === void 0 ? emptySort.current : _a,\n      onSortChange = props.onSortChange,\n      onFilterChange = props.onFilterChange,\n      initialFilter = props.initialFilter,\n      _b = props.sortAsc,\n      sortAsc = _b === void 0 ? false : _b,\n      _c = props.sortDesc,\n      sortDesc = _c === void 0 ? false : _c,\n      _d = props.filterContent,\n      filterContent = _d === void 0 ? [] : _d,\n      _e = props.expandFilters,\n      expandFilters = _e === void 0 ? false : _e;\n\n  var _f = React.useState(false),\n      show = _f[0],\n      setShow = _f[1];\n\n  var _g = React.useState(expandFilters),\n      filterExpand = _g[0],\n      setFilterExpand = _g[1];\n\n  var _h = React.useState(field && initialFilter ? initialFilter(field) : null),\n      currentFilter = _h[0],\n      setCurrentFilter = _h[1];\n\n  var anchor = React.useRef(null);\n  var popupRef = React.useRef(null);\n  var blurTimeout = React.useRef(null);\n  var willBlur = React.useRef(false);\n  var menuFilter = React.useCallback(function () {\n    return (filter || []).find(function (f) {\n      return f.filters.every(function (inF) {\n        return !isCompositeFilterDescriptor(inF) && inF.field === field;\n      });\n    });\n  }, [filter, field]);\n  var closeMenu = React.useCallback(function () {\n    setShow(false);\n  }, []);\n  var onBlur = React.useCallback(function () {\n    if (willBlur.current) {\n      willBlur.current = false;\n      return;\n    }\n\n    clearTimeout(blurTimeout.current);\n    blurTimeout.current = window.setTimeout(function () {\n      closeMenu();\n    });\n  }, [closeMenu]);\n  var onFocus = React.useCallback(function () {\n    return clearTimeout(blurTimeout.current);\n  }, []);\n  var onAnchorMouseDown = React.useCallback(function (event) {\n    willBlur.current = show && event.currentTarget === anchor.current;\n  }, [show]);\n  var onColumnMenuButtonClick = React.useCallback(function () {\n    setShow(!show);\n\n    if (field && initialFilter) {\n      setFilterExpand(!show ? expandFilters : false);\n      setCurrentFilter(show ? currentFilter : menuFilter() || initialFilter(field));\n    }\n  }, [menuFilter, field, show, currentFilter, initialFilter, expandFilters]);\n  React.useEffect(function () {\n    if (show && popupRef.current) {\n      popupRef.current.focus();\n    }\n  }, [show]);\n  var filterItemClick = React.useCallback(function () {\n    return setFilterExpand(!filterExpand);\n  }, [filterExpand]);\n  var changeSort = React.useCallback(function (event, dir) {\n    var newSort = __spreadArray([], sort, true);\n\n    var currentSortIndex = newSort.findIndex(function (d) {\n      return d.field === field;\n    });\n    var newSortDescriptor = {\n      field: field,\n      dir: dir\n    };\n\n    if (currentSortIndex >= 0) {\n      if (newSort[currentSortIndex].dir !== newSortDescriptor.dir) {\n        newSort.splice(currentSortIndex, 1, newSortDescriptor);\n      } else {\n        newSort.splice(currentSortIndex, 1);\n      }\n    } else {\n      newSort.push(newSortDescriptor);\n    }\n\n    closeMenu();\n\n    if (onSortChange) {\n      onSortChange.call(undefined, event, newSort, field);\n    }\n  }, [sort, field, onSortChange, closeMenu]);\n  var filterChange = React.useCallback(function (_event, nextFilter, prevFilter) {\n    var stateFilter = __assign(__assign({}, currentFilter), {\n      filters: __spreadArray([], currentFilter.filters, true)\n    });\n\n    var index = stateFilter.filters.indexOf(prevFilter);\n    stateFilter.filters.splice(index, 1, nextFilter);\n    setCurrentFilter(stateFilter);\n  }, [currentFilter]);\n  var onFilterSubmit = React.useCallback(function (event) {\n    event.preventDefault();\n    var newFilter = (filter || []).slice();\n    var prev = menuFilter();\n    var index = prev ? newFilter.indexOf(prev) : -1;\n\n    if (index >= 0) {\n      newFilter.splice(index, 1, currentFilter);\n    } else {\n      newFilter.push(currentFilter);\n    }\n\n    closeMenu();\n\n    if (onFilterChange) {\n      onFilterChange.call(undefined, event, newFilter, field);\n    }\n  }, [filter, currentFilter, field, onFilterChange, closeMenu, menuFilter]);\n  var onFilterReset = React.useCallback(function (event) {\n    var newFilter = (filter || []).slice();\n    var prev = menuFilter();\n    var index = prev ? newFilter.indexOf(prev) : -1;\n\n    if (index >= 0) {\n      newFilter.splice(index, 1);\n    }\n\n    if (initialFilter) {\n      setCurrentFilter(initialFilter(field));\n    }\n\n    closeMenu();\n\n    if (onFilterChange) {\n      onFilterChange.call(undefined, event, newFilter, field);\n    }\n  }, [filter, field, onFilterChange, initialFilter, closeMenu, menuFilter]);\n  var sortAscChange = React.useCallback(function (e) {\n    return changeSort(e, 'asc');\n  }, [changeSort]);\n  var sortDescChange = React.useCallback(function (e) {\n    return changeSort(e, 'desc');\n  }, [changeSort]);\n  var onLogicChange = React.useCallback(function (event) {\n    return currentFilter && setCurrentFilter(__assign(__assign({}, currentFilter), {\n      logic: event.value.logic\n    }));\n  }, [currentFilter]);\n  var currentSort = sort.find(function (d) {\n    return d.field === field;\n  }) || {\n    dir: ''\n  };\n  var FirstFilterComponent = filterContent[0],\n      FilterLogicComponent = filterContent[1],\n      SecondFilterComponent = filterContent[2];\n  var localization = useLocalization();\n  var sorting = sortAsc || sortDesc ? React.createElement(\"div\", {\n    className: \"k-columnmenu-item-wrapper\",\n    key: \"sorting\"\n  }, sortAsc && React.createElement(ColumnMenuItem, {\n    title: localization.toLanguageString(columnMenuSortAscending, messages[columnMenuSortAscending]),\n    iconClass: \"k-i-sort-asc-sm\",\n    selected: currentSort.dir === 'asc',\n    onClick: sortAscChange\n  }), sortDesc && React.createElement(ColumnMenuItem, {\n    title: localization.toLanguageString(columnMenuSortDescending, messages[columnMenuSortDescending]),\n    iconClass: \"k-i-sort-desc-sm\",\n    selected: currentSort.dir === 'desc',\n    onClick: sortDescChange\n  })) : null; // filter content empty when no field is supplied\n\n  var filtering = currentFilter && filterContent.length > 0 ? React.createElement(\"div\", {\n    className: \"k-columnmenu-item-wrapper\",\n    key: \"filtering\"\n  }, React.createElement(ColumnMenuItem, {\n    iconClass: \"k-i-filter\",\n    title: localization.toLanguageString(columnMenuFilterTitle, messages[columnMenuFilterTitle]),\n    onClick: filterItemClick\n  }), React.createElement(ColumnMenuFilterForm, {\n    show: filterExpand,\n    onSubmit: onFilterSubmit,\n    onReset: onFilterReset\n  }, FirstFilterComponent && React.createElement(FirstFilterComponent, {\n    filter: currentFilter.filters[0],\n    onFilterChange: filterChange\n  }), FilterLogicComponent && React.createElement(FilterLogicComponent, {\n    value: currentFilter.logic,\n    onChange: onLogicChange\n  }), SecondFilterComponent && React.createElement(SecondFilterComponent, {\n    filter: currentFilter.filters[1],\n    onFilterChange: filterChange\n  }))) : null;\n  var menuItems = [sorting, filtering];\n  var button = React.createElement(\"span\", {\n    ref: anchor,\n    onClick: onColumnMenuButtonClick,\n    onMouseDown: onAnchorMouseDown,\n    className: 'k-grid-header-menu k-grid-column-menu' + (Boolean(menuFilter()) ? ' k-active' : ''),\n    key: \"button\"\n  }, React.createElement(\"span\", {\n    className: \"k-icon k-i-more-vertical\"\n  }));\n  var popup = React.createElement(Popup, {\n    anchor: anchor.current,\n    show: show,\n    key: \"popup\"\n  }, React.createElement(\"div\", {\n    className: \"k-grid-columnmenu-popup\",\n    ref: popupRef,\n    tabIndex: 0,\n    onBlur: onBlur,\n    onFocus: onFocus,\n    style: {\n      outline: 'none'\n    }\n  }, props.itemsRender ? props.itemsRender.call(undefined, menuItems, {\n    closeMenu: closeMenu,\n    field: field\n  }) : menuItems));\n  var rendering = [button, popup];\n  return React.createElement(React.Fragment, null, props.render ? props.render.call(undefined, rendering) : rendering);\n};\n/**\n * The `ColumnMenuTextColumn` component. Use it for `string` type columns.\n */\n\n\nexport var ColumnMenuTextColumn = function (props) {\n  var field = props.field,\n      others = __rest(props, [\"field\"]);\n\n  var initialFilter = React.useCallback(function (currentField) {\n    return {\n      logic: 'and',\n      filters: [{\n        operator: 'contains',\n        field: currentField,\n        value: ''\n      }, {\n        operator: 'contains',\n        field: currentField,\n        value: ''\n      }]\n    };\n  }, []);\n  var hasField = Boolean(props.field);\n  var filterContent = hasField ? [ColumnMenuTextFilter, ColumnMenuFilterLogic, ColumnMenuTextFilter] : [];\n  return React.createElement(ColumnMenuWrapper, __assign({\n    sortAsc: true && hasField,\n    sortDesc: true && hasField,\n    filterContent: filterContent,\n    initialFilter: hasField ? initialFilter : undefined,\n    field: field\n  }, others));\n};\n/**\n * The `ColumnMenuNumericColumn` component. Use it for `number` type columns.\n */\n\nexport var ColumnMenuNumericColumn = function (props) {\n  var field = props.field,\n      others = __rest(props, [\"field\"]);\n\n  var initialFilter = React.useCallback(function (currentField) {\n    return {\n      logic: 'or',\n      filters: [{\n        operator: 'eq',\n        field: currentField,\n        value: null\n      }, {\n        operator: 'eq',\n        field: currentField,\n        value: null\n      }]\n    };\n  }, []);\n  var hasField = Boolean(props.field);\n  var filterContent = hasField ? [ColumnMenuNumericFilter, ColumnMenuFilterLogic, ColumnMenuNumericFilter] : [];\n  return React.createElement(ColumnMenuWrapper, __assign({\n    sortAsc: true && hasField,\n    sortDesc: true && hasField,\n    filterContent: filterContent,\n    initialFilter: hasField ? initialFilter : undefined,\n    field: field\n  }, others));\n};\n/**\n * The `ColumnMenuDateColumn` component. Use it for `Date` type columns.\n */\n\nexport var ColumnMenuDateColumn = function (props) {\n  var field = props.field,\n      others = __rest(props, [\"field\"]);\n\n  var initialFilter = React.useCallback(function (currentField) {\n    return {\n      logic: 'or',\n      filters: [{\n        operator: 'eq',\n        field: currentField,\n        value: null\n      }, {\n        operator: 'eq',\n        field: currentField,\n        value: null\n      }]\n    };\n  }, []);\n  var hasField = Boolean(props.field);\n  var filterContent = hasField ? [ColumnMenuDateFilter, ColumnMenuFilterLogic, ColumnMenuDateFilter] : [];\n  return React.createElement(ColumnMenuWrapper, __assign({\n    sortAsc: true && hasField,\n    sortDesc: true && hasField,\n    filterContent: filterContent,\n    initialFilter: hasField ? initialFilter : undefined,\n    field: field\n  }, others));\n};\n/**\n * The `ColumnMenuBooleanColumn` component. Use it for `boolean` type columns.\n */\n\nexport var ColumnMenuBooleanColumn = function (props) {\n  var field = props.field,\n      others = __rest(props, [\"field\"]);\n\n  var initialFilter = React.useCallback(function (currentField) {\n    return {\n      logic: 'and',\n      filters: [{\n        operator: 'eq',\n        field: currentField,\n        value: false\n      }]\n    };\n  }, []);\n  var hasField = Boolean(props.field);\n  var filterContent = hasField ? [ColumnMenuBooleanFilter] : [];\n  return React.createElement(ColumnMenuWrapper, __assign({\n    sortAsc: true && hasField,\n    sortDesc: true && hasField,\n    filterContent: filterContent,\n    initialFilter: hasField ? initialFilter : undefined,\n    field: field\n  }, others));\n};","map":{"version":3,"sources":["C:/Projects/React/heycloud-frontent-2/node_modules/@progress/kendo-react-data-tools/dist/es/columnmenu/ColumnMenu.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__spreadArray","to","from","pack","l","ar","Array","slice","concat","React","Popup","useLocalization","isCompositeFilterDescriptor","ColumnMenuItem","ColumnMenuTextFilter","ColumnMenuNumericFilter","ColumnMenuDateFilter","ColumnMenuBooleanFilter","ColumnMenuFilterLogic","ColumnMenuFilterForm","messages","columnMenuFilterTitle","columnMenuSortAscending","columnMenuSortDescending","validatePackage","packageMetadata","ColumnMenuWrapper","props","emptySort","useRef","field","filter","_a","sort","current","onSortChange","onFilterChange","initialFilter","_b","sortAsc","_c","sortDesc","_d","filterContent","_e","expandFilters","_f","useState","show","setShow","_g","filterExpand","setFilterExpand","_h","currentFilter","setCurrentFilter","anchor","popupRef","blurTimeout","willBlur","menuFilter","useCallback","find","f","filters","every","inF","closeMenu","onBlur","clearTimeout","window","setTimeout","onFocus","onAnchorMouseDown","event","currentTarget","onColumnMenuButtonClick","useEffect","focus","filterItemClick","changeSort","dir","newSort","currentSortIndex","findIndex","d","newSortDescriptor","splice","push","undefined","filterChange","_event","nextFilter","prevFilter","stateFilter","index","onFilterSubmit","preventDefault","newFilter","prev","onFilterReset","sortAscChange","sortDescChange","onLogicChange","logic","value","currentSort","FirstFilterComponent","FilterLogicComponent","SecondFilterComponent","localization","sorting","createElement","className","key","title","toLanguageString","iconClass","selected","onClick","filtering","onSubmit","onReset","onChange","menuItems","button","ref","onMouseDown","Boolean","popup","tabIndex","style","outline","itemsRender","rendering","Fragment","render","ColumnMenuTextColumn","others","currentField","operator","hasField","ColumnMenuNumericColumn","ColumnMenuDateColumn","ColumnMenuBooleanColumn"],"mappings":"AAAA,IAAIA,QAAQ,GAAI,QAAQ,KAAKA,QAAd,IAA2B,YAAY;AAClDA,EAAAA,QAAQ,GAAGC,MAAM,CAACC,MAAP,IAAiB,UAASC,CAAT,EAAY;AACpC,SAAK,IAAIC,CAAJ,EAAOC,CAAC,GAAG,CAAX,EAAcC,CAAC,GAAGC,SAAS,CAACC,MAAjC,EAAyCH,CAAC,GAAGC,CAA7C,EAAgDD,CAAC,EAAjD,EAAqD;AACjDD,MAAAA,CAAC,GAAGG,SAAS,CAACF,CAAD,CAAb;;AACA,WAAK,IAAII,CAAT,IAAcL,CAAd,EAAiB,IAAIH,MAAM,CAACS,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCR,CAArC,EAAwCK,CAAxC,CAAJ,EACbN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AACP;;AACD,WAAON,CAAP;AACH,GAPD;;AAQA,SAAOH,QAAQ,CAACa,KAAT,CAAe,IAAf,EAAqBN,SAArB,CAAP;AACH,CAVD;;AAWA,IAAIO,MAAM,GAAI,QAAQ,KAAKA,MAAd,IAAyB,UAAUV,CAAV,EAAaW,CAAb,EAAgB;AAClD,MAAIZ,CAAC,GAAG,EAAR;;AACA,OAAK,IAAIM,CAAT,IAAcL,CAAd,EAAiB,IAAIH,MAAM,CAACS,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCR,CAArC,EAAwCK,CAAxC,KAA8CM,CAAC,CAACC,OAAF,CAAUP,CAAV,IAAe,CAAjE,EACbN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;;AACJ,MAAIL,CAAC,IAAI,IAAL,IAAa,OAAOH,MAAM,CAACgB,qBAAd,KAAwC,UAAzD,EACI,KAAK,IAAIZ,CAAC,GAAG,CAAR,EAAWI,CAAC,GAAGR,MAAM,CAACgB,qBAAP,CAA6Bb,CAA7B,CAApB,EAAqDC,CAAC,GAAGI,CAAC,CAACD,MAA3D,EAAmEH,CAAC,EAApE,EAAwE;AACpE,QAAIU,CAAC,CAACC,OAAF,CAAUP,CAAC,CAACJ,CAAD,CAAX,IAAkB,CAAlB,IAAuBJ,MAAM,CAACS,SAAP,CAAiBQ,oBAAjB,CAAsCN,IAAtC,CAA2CR,CAA3C,EAA8CK,CAAC,CAACJ,CAAD,CAA/C,CAA3B,EACIF,CAAC,CAACM,CAAC,CAACJ,CAAD,CAAF,CAAD,GAAUD,CAAC,CAACK,CAAC,CAACJ,CAAD,CAAF,CAAX;AACP;AACL,SAAOF,CAAP;AACH,CAVD;;AAWA,IAAIgB,aAAa,GAAI,QAAQ,KAAKA,aAAd,IAAgC,UAAUC,EAAV,EAAcC,IAAd,EAAoBC,IAApB,EAA0B;AAC1E,MAAIA,IAAI,IAAIf,SAAS,CAACC,MAAV,KAAqB,CAAjC,EAAoC,KAAK,IAAIH,CAAC,GAAG,CAAR,EAAWkB,CAAC,GAAGF,IAAI,CAACb,MAApB,EAA4BgB,EAAjC,EAAqCnB,CAAC,GAAGkB,CAAzC,EAA4ClB,CAAC,EAA7C,EAAiD;AACjF,QAAImB,EAAE,IAAI,EAAEnB,CAAC,IAAIgB,IAAP,CAAV,EAAwB;AACpB,UAAI,CAACG,EAAL,EAASA,EAAE,GAAGC,KAAK,CAACf,SAAN,CAAgBgB,KAAhB,CAAsBd,IAAtB,CAA2BS,IAA3B,EAAiC,CAAjC,EAAoChB,CAApC,CAAL;AACTmB,MAAAA,EAAE,CAACnB,CAAD,CAAF,GAAQgB,IAAI,CAAChB,CAAD,CAAZ;AACH;AACJ;AACD,SAAOe,EAAE,CAACO,MAAH,CAAUH,EAAE,IAAIC,KAAK,CAACf,SAAN,CAAgBgB,KAAhB,CAAsBd,IAAtB,CAA2BS,IAA3B,CAAhB,CAAP;AACH,CARD;;AASA,OAAO,KAAKO,KAAZ,MAAuB,OAAvB;AACA,SAASC,KAAT,QAAsB,6BAAtB;AACA,SAASC,eAAT,QAAgC,4BAAhC;AACA,SAASC,2BAAT,QAA4C,4BAA5C;AACA,SAASC,cAAT,QAA+B,kBAA/B;AACA,SAASC,oBAAT,EAA+BC,uBAA/B,EAAwDC,oBAAxD,EAA8EC,uBAA9E,QAA6G,qBAA7G;AACA,SAASC,qBAAT,QAAsC,yBAAtC;AACA,SAASC,oBAAT,QAAqC,wBAArC;AACA,SAASC,QAAT,EAAmBC,qBAAnB,EAA0CC,uBAA1C,EAAmEC,wBAAnE,QAAmG,aAAnG;AACA,SAASC,eAAT,QAAgC,8BAAhC;AACA,SAASC,eAAT,QAAgC,qBAAhC;AACA;;AACA,IAAIC,iBAAiB,GAAG,UAAUC,KAAV,EAAiB;AACrCH,EAAAA,eAAe,CAACC,eAAD,CAAf;AACA,MAAIG,SAAS,GAAGnB,KAAK,CAACoB,MAAN,CAAa,EAAb,CAAhB;AACA,MAAIC,KAAK,GAAGH,KAAK,CAACG,KAAlB;AAAA,MAAyBC,MAAM,GAAGJ,KAAK,CAACI,MAAxC;AAAA,MAAgDC,EAAE,GAAGL,KAAK,CAACM,IAA3D;AAAA,MAAiEA,IAAI,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgBJ,SAAS,CAACM,OAA1B,GAAoCF,EAA5G;AAAA,MAAgHG,YAAY,GAAGR,KAAK,CAACQ,YAArI;AAAA,MAAmJC,cAAc,GAAGT,KAAK,CAACS,cAA1K;AAAA,MAA0LC,aAAa,GAAGV,KAAK,CAACU,aAAhN;AAAA,MAA+NC,EAAE,GAAGX,KAAK,CAACY,OAA1O;AAAA,MAAmPA,OAAO,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,KAAhB,GAAwBA,EAArR;AAAA,MAAyRE,EAAE,GAAGb,KAAK,CAACc,QAApS;AAAA,MAA8SA,QAAQ,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,KAAhB,GAAwBA,EAAjV;AAAA,MAAqVE,EAAE,GAAGf,KAAK,CAACgB,aAAhW;AAAA,MAA+WA,aAAa,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EAApZ;AAAA,MAAwZE,EAAE,GAAGjB,KAAK,CAACkB,aAAna;AAAA,MAAkbA,aAAa,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,KAAhB,GAAwBA,EAA1d;;AACA,MAAIE,EAAE,GAAGrC,KAAK,CAACsC,QAAN,CAAe,KAAf,CAAT;AAAA,MAAgCC,IAAI,GAAGF,EAAE,CAAC,CAAD,CAAzC;AAAA,MAA8CG,OAAO,GAAGH,EAAE,CAAC,CAAD,CAA1D;;AACA,MAAII,EAAE,GAAGzC,KAAK,CAACsC,QAAN,CAAeF,aAAf,CAAT;AAAA,MAAwCM,YAAY,GAAGD,EAAE,CAAC,CAAD,CAAzD;AAAA,MAA8DE,eAAe,GAAGF,EAAE,CAAC,CAAD,CAAlF;;AACA,MAAIG,EAAE,GAAG5C,KAAK,CAACsC,QAAN,CAAejB,KAAK,IAAIO,aAAT,GAAyBA,aAAa,CAACP,KAAD,CAAtC,GAAgD,IAA/D,CAAT;AAAA,MAA+EwB,aAAa,GAAGD,EAAE,CAAC,CAAD,CAAjG;AAAA,MAAsGE,gBAAgB,GAAGF,EAAE,CAAC,CAAD,CAA3H;;AACA,MAAIG,MAAM,GAAG/C,KAAK,CAACoB,MAAN,CAAa,IAAb,CAAb;AACA,MAAI4B,QAAQ,GAAGhD,KAAK,CAACoB,MAAN,CAAa,IAAb,CAAf;AACA,MAAI6B,WAAW,GAAGjD,KAAK,CAACoB,MAAN,CAAa,IAAb,CAAlB;AACA,MAAI8B,QAAQ,GAAGlD,KAAK,CAACoB,MAAN,CAAa,KAAb,CAAf;AACA,MAAI+B,UAAU,GAAGnD,KAAK,CAACoD,WAAN,CAAkB,YAAY;AAC3C,WAAO,CAAC9B,MAAM,IAAI,EAAX,EAAe+B,IAAf,CAAoB,UAAUC,CAAV,EAAa;AAAE,aAAOA,CAAC,CAACC,OAAF,CAAUC,KAAV,CAAgB,UAAUC,GAAV,EAAe;AAAE,eAAO,CAACtD,2BAA2B,CAACsD,GAAD,CAA5B,IAAqCA,GAAG,CAACpC,KAAJ,KAAcA,KAA1D;AAAkE,OAAnG,CAAP;AAA8G,KAAjJ,CAAP;AACH,GAFgB,EAEd,CAACC,MAAD,EAASD,KAAT,CAFc,CAAjB;AAGA,MAAIqC,SAAS,GAAG1D,KAAK,CAACoD,WAAN,CAAkB,YAAY;AAC1CZ,IAAAA,OAAO,CAAC,KAAD,CAAP;AACH,GAFe,EAEb,EAFa,CAAhB;AAGA,MAAImB,MAAM,GAAG3D,KAAK,CAACoD,WAAN,CAAkB,YAAY;AACvC,QAAIF,QAAQ,CAACzB,OAAb,EAAsB;AAClByB,MAAAA,QAAQ,CAACzB,OAAT,GAAmB,KAAnB;AACA;AACH;;AACDmC,IAAAA,YAAY,CAACX,WAAW,CAACxB,OAAb,CAAZ;AACAwB,IAAAA,WAAW,CAACxB,OAAZ,GAAsBoC,MAAM,CAACC,UAAP,CAAkB,YAAY;AAAEJ,MAAAA,SAAS;AAAK,KAA9C,CAAtB;AACH,GAPY,EAOV,CAACA,SAAD,CAPU,CAAb;AAQA,MAAIK,OAAO,GAAG/D,KAAK,CAACoD,WAAN,CAAkB,YAAY;AAAE,WAAOQ,YAAY,CAACX,WAAW,CAACxB,OAAb,CAAnB;AAA2C,GAA3E,EAA6E,EAA7E,CAAd;AACA,MAAIuC,iBAAiB,GAAGhE,KAAK,CAACoD,WAAN,CAAkB,UAAUa,KAAV,EAAiB;AACvDf,IAAAA,QAAQ,CAACzB,OAAT,GAAmBc,IAAI,IAAI0B,KAAK,CAACC,aAAN,KAAwBnB,MAAM,CAACtB,OAA1D;AACH,GAFuB,EAErB,CAACc,IAAD,CAFqB,CAAxB;AAGA,MAAI4B,uBAAuB,GAAGnE,KAAK,CAACoD,WAAN,CAAkB,YAAY;AACxDZ,IAAAA,OAAO,CAAC,CAACD,IAAF,CAAP;;AACA,QAAIlB,KAAK,IAAIO,aAAb,EAA4B;AACxBe,MAAAA,eAAe,CAAC,CAACJ,IAAD,GAAQH,aAAR,GAAwB,KAAzB,CAAf;AACAU,MAAAA,gBAAgB,CAACP,IAAI,GACjBM,aADiB,GAEhBM,UAAU,MAAMvB,aAAa,CAACP,KAAD,CAFlB,CAAhB;AAGH;AACJ,GAR6B,EAQ3B,CAAC8B,UAAD,EAAa9B,KAAb,EAAoBkB,IAApB,EAA0BM,aAA1B,EAAyCjB,aAAzC,EAAwDQ,aAAxD,CAR2B,CAA9B;AASApC,EAAAA,KAAK,CAACoE,SAAN,CAAgB,YAAY;AACxB,QAAI7B,IAAI,IAAIS,QAAQ,CAACvB,OAArB,EAA8B;AAC1BuB,MAAAA,QAAQ,CAACvB,OAAT,CAAiB4C,KAAjB;AACH;AACJ,GAJD,EAIG,CAAC9B,IAAD,CAJH;AAKA,MAAI+B,eAAe,GAAGtE,KAAK,CAACoD,WAAN,CAAkB,YAAY;AAAE,WAAOT,eAAe,CAAC,CAACD,YAAF,CAAtB;AAAwC,GAAxE,EAA0E,CAACA,YAAD,CAA1E,CAAtB;AACA,MAAI6B,UAAU,GAAGvE,KAAK,CAACoD,WAAN,CAAkB,UAAUa,KAAV,EAAiBO,GAAjB,EAAsB;AACrD,QAAIC,OAAO,GAAGlF,aAAa,CAAC,EAAD,EAAKiC,IAAL,EAAW,IAAX,CAA3B;;AACA,QAAIkD,gBAAgB,GAAGD,OAAO,CAACE,SAAR,CAAkB,UAAUC,CAAV,EAAa;AAAE,aAAOA,CAAC,CAACvD,KAAF,KAAYA,KAAnB;AAA2B,KAA5D,CAAvB;AACA,QAAIwD,iBAAiB,GAAG;AAAExD,MAAAA,KAAK,EAAEA,KAAT;AAAgBmD,MAAAA,GAAG,EAAEA;AAArB,KAAxB;;AACA,QAAIE,gBAAgB,IAAI,CAAxB,EAA2B;AACvB,UAAID,OAAO,CAACC,gBAAD,CAAP,CAA0BF,GAA1B,KAAkCK,iBAAiB,CAACL,GAAxD,EAA6D;AACzDC,QAAAA,OAAO,CAACK,MAAR,CAAeJ,gBAAf,EAAiC,CAAjC,EAAoCG,iBAApC;AACH,OAFD,MAGK;AACDJ,QAAAA,OAAO,CAACK,MAAR,CAAeJ,gBAAf,EAAiC,CAAjC;AACH;AACJ,KAPD,MAQK;AACDD,MAAAA,OAAO,CAACM,IAAR,CAAaF,iBAAb;AACH;;AACDnB,IAAAA,SAAS;;AACT,QAAIhC,YAAJ,EAAkB;AACdA,MAAAA,YAAY,CAAC1C,IAAb,CAAkBgG,SAAlB,EAA6Bf,KAA7B,EAAoCQ,OAApC,EAA6CpD,KAA7C;AACH;AACJ,GAnBgB,EAmBd,CAACG,IAAD,EAAOH,KAAP,EAAcK,YAAd,EAA4BgC,SAA5B,CAnBc,CAAjB;AAoBA,MAAIuB,YAAY,GAAGjF,KAAK,CAACoD,WAAN,CAAkB,UAAU8B,MAAV,EAAkBC,UAAlB,EAA8BC,UAA9B,EAA0C;AAC3E,QAAIC,WAAW,GAAGjH,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKyE,aAAL,CAAT,EAA8B;AAAEU,MAAAA,OAAO,EAAEhE,aAAa,CAAC,EAAD,EAAKsD,aAAa,CAACU,OAAnB,EAA4B,IAA5B;AAAxB,KAA9B,CAA1B;;AACA,QAAI+B,KAAK,GAAGD,WAAW,CAAC9B,OAAZ,CAAoBnE,OAApB,CAA4BgG,UAA5B,CAAZ;AACAC,IAAAA,WAAW,CAAC9B,OAAZ,CAAoBuB,MAApB,CAA2BQ,KAA3B,EAAkC,CAAlC,EAAqCH,UAArC;AACArC,IAAAA,gBAAgB,CAACuC,WAAD,CAAhB;AACH,GALkB,EAKhB,CAACxC,aAAD,CALgB,CAAnB;AAMA,MAAI0C,cAAc,GAAGvF,KAAK,CAACoD,WAAN,CAAkB,UAAUa,KAAV,EAAiB;AACpDA,IAAAA,KAAK,CAACuB,cAAN;AACA,QAAIC,SAAS,GAAG,CAACnE,MAAM,IAAI,EAAX,EAAexB,KAAf,EAAhB;AACA,QAAI4F,IAAI,GAAGvC,UAAU,EAArB;AACA,QAAImC,KAAK,GAAGI,IAAI,GAAGD,SAAS,CAACrG,OAAV,CAAkBsG,IAAlB,CAAH,GAA6B,CAAC,CAA9C;;AACA,QAAIJ,KAAK,IAAI,CAAb,EAAgB;AACZG,MAAAA,SAAS,CAACX,MAAV,CAAiBQ,KAAjB,EAAwB,CAAxB,EAA2BzC,aAA3B;AACH,KAFD,MAGK;AACD4C,MAAAA,SAAS,CAACV,IAAV,CAAelC,aAAf;AACH;;AACDa,IAAAA,SAAS;;AACT,QAAI/B,cAAJ,EAAoB;AAChBA,MAAAA,cAAc,CAAC3C,IAAf,CAAoBgG,SAApB,EAA+Bf,KAA/B,EAAsCwB,SAAtC,EAAiDpE,KAAjD;AACH;AACJ,GAfoB,EAelB,CAACC,MAAD,EAASuB,aAAT,EAAwBxB,KAAxB,EAA+BM,cAA/B,EAA+C+B,SAA/C,EAA0DP,UAA1D,CAfkB,CAArB;AAgBA,MAAIwC,aAAa,GAAG3F,KAAK,CAACoD,WAAN,CAAkB,UAAUa,KAAV,EAAiB;AACnD,QAAIwB,SAAS,GAAG,CAACnE,MAAM,IAAI,EAAX,EAAexB,KAAf,EAAhB;AACA,QAAI4F,IAAI,GAAGvC,UAAU,EAArB;AACA,QAAImC,KAAK,GAAGI,IAAI,GAAGD,SAAS,CAACrG,OAAV,CAAkBsG,IAAlB,CAAH,GAA6B,CAAC,CAA9C;;AACA,QAAIJ,KAAK,IAAI,CAAb,EAAgB;AACZG,MAAAA,SAAS,CAACX,MAAV,CAAiBQ,KAAjB,EAAwB,CAAxB;AACH;;AACD,QAAI1D,aAAJ,EAAmB;AACfkB,MAAAA,gBAAgB,CAAClB,aAAa,CAACP,KAAD,CAAd,CAAhB;AACH;;AACDqC,IAAAA,SAAS;;AACT,QAAI/B,cAAJ,EAAoB;AAChBA,MAAAA,cAAc,CAAC3C,IAAf,CAAoBgG,SAApB,EAA+Bf,KAA/B,EAAsCwB,SAAtC,EAAiDpE,KAAjD;AACH;AACJ,GAdmB,EAcjB,CAACC,MAAD,EAASD,KAAT,EAAgBM,cAAhB,EAAgCC,aAAhC,EAA+C8B,SAA/C,EAA0DP,UAA1D,CAdiB,CAApB;AAeA,MAAIyC,aAAa,GAAG5F,KAAK,CAACoD,WAAN,CAAkB,UAAUjE,CAAV,EAAa;AAAE,WAAOoF,UAAU,CAACpF,CAAD,EAAI,KAAJ,CAAjB;AAA8B,GAA/D,EAAiE,CAACoF,UAAD,CAAjE,CAApB;AACA,MAAIsB,cAAc,GAAG7F,KAAK,CAACoD,WAAN,CAAkB,UAAUjE,CAAV,EAAa;AAAE,WAAOoF,UAAU,CAACpF,CAAD,EAAI,MAAJ,CAAjB;AAA+B,GAAhE,EAAkE,CAACoF,UAAD,CAAlE,CAArB;AACA,MAAIuB,aAAa,GAAG9F,KAAK,CAACoD,WAAN,CAAkB,UAAUa,KAAV,EAAiB;AAAE,WAAOpB,aAAa,IAAIC,gBAAgB,CAAC1E,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKyE,aAAL,CAAT,EAA8B;AAAEkD,MAAAA,KAAK,EAAE9B,KAAK,CAAC+B,KAAN,CAAYD;AAArB,KAA9B,CAAT,CAAxC;AAAgH,GAArJ,EAAuJ,CAAClD,aAAD,CAAvJ,CAApB;AACA,MAAIoD,WAAW,GAAGzE,IAAI,CAAC6B,IAAL,CAAU,UAAUuB,CAAV,EAAa;AAAE,WAAOA,CAAC,CAACvD,KAAF,KAAYA,KAAnB;AAA2B,GAApD,KAAyD;AAAEmD,IAAAA,GAAG,EAAE;AAAP,GAA3E;AACA,MAAI0B,oBAAoB,GAAGhE,aAAa,CAAC,CAAD,CAAxC;AAAA,MAA6CiE,oBAAoB,GAAGjE,aAAa,CAAC,CAAD,CAAjF;AAAA,MAAsFkE,qBAAqB,GAAGlE,aAAa,CAAC,CAAD,CAA3H;AACA,MAAImE,YAAY,GAAGnG,eAAe,EAAlC;AACA,MAAIoG,OAAO,GAAIxE,OAAO,IAAIE,QAAZ,GAAyBhC,KAAK,CAACuG,aAAN,CAAoB,KAApB,EAA2B;AAAEC,IAAAA,SAAS,EAAE,2BAAb;AAA0CC,IAAAA,GAAG,EAAE;AAA/C,GAA3B,EACnC3E,OAAO,IACF9B,KAAK,CAACuG,aAAN,CAAoBnG,cAApB,EAAoC;AAAEsG,IAAAA,KAAK,EAAEL,YAAY,CAACM,gBAAb,CAA8B9F,uBAA9B,EAAuDF,QAAQ,CAACE,uBAAD,CAA/D,CAAT;AAAoG+F,IAAAA,SAAS,EAAE,iBAA/G;AAAkIC,IAAAA,QAAQ,EAAEZ,WAAW,CAACzB,GAAZ,KAAoB,KAAhK;AAAuKsC,IAAAA,OAAO,EAAElB;AAAhL,GAApC,CAF8B,EAGnC5D,QAAQ,IACHhC,KAAK,CAACuG,aAAN,CAAoBnG,cAApB,EAAoC;AAAEsG,IAAAA,KAAK,EAAEL,YAAY,CAACM,gBAAb,CAA8B7F,wBAA9B,EAAwDH,QAAQ,CAACG,wBAAD,CAAhE,CAAT;AAAsG8F,IAAAA,SAAS,EAAE,kBAAjH;AAAqIC,IAAAA,QAAQ,EAAEZ,WAAW,CAACzB,GAAZ,KAAoB,MAAnK;AAA2KsC,IAAAA,OAAO,EAAEjB;AAApL,GAApC,CAJ8B,CAAzB,GAI0O,IAJxP,CA3GqC,CAgHrC;;AACA,MAAIkB,SAAS,GAAGlE,aAAa,IAAIX,aAAa,CAACtD,MAAd,GAAuB,CAAxC,GAA6CoB,KAAK,CAACuG,aAAN,CAAoB,KAApB,EAA2B;AAAEC,IAAAA,SAAS,EAAE,2BAAb;AAA0CC,IAAAA,GAAG,EAAE;AAA/C,GAA3B,EACzDzG,KAAK,CAACuG,aAAN,CAAoBnG,cAApB,EAAoC;AAAEwG,IAAAA,SAAS,EAAE,YAAb;AAA2BF,IAAAA,KAAK,EAAEL,YAAY,CAACM,gBAAb,CAA8B/F,qBAA9B,EAAqDD,QAAQ,CAACC,qBAAD,CAA7D,CAAlC;AAAyHkG,IAAAA,OAAO,EAAExC;AAAlI,GAApC,CADyD,EAEzDtE,KAAK,CAACuG,aAAN,CAAoB7F,oBAApB,EAA0C;AAAE6B,IAAAA,IAAI,EAAEG,YAAR;AAAsBsE,IAAAA,QAAQ,EAAEzB,cAAhC;AAAgD0B,IAAAA,OAAO,EAAEtB;AAAzD,GAA1C,EACIO,oBAAoB,IAChBlG,KAAK,CAACuG,aAAN,CAAoBL,oBAApB,EAA0C;AAAE5E,IAAAA,MAAM,EAAEuB,aAAa,CAACU,OAAd,CAAsB,CAAtB,CAAV;AAAoC5B,IAAAA,cAAc,EAAEsD;AAApD,GAA1C,CAFR,EAGIkB,oBAAoB,IAChBnG,KAAK,CAACuG,aAAN,CAAoBJ,oBAApB,EAA0C;AAAEH,IAAAA,KAAK,EAAEnD,aAAa,CAACkD,KAAvB;AAA8BmB,IAAAA,QAAQ,EAAEpB;AAAxC,GAA1C,CAJR,EAKIM,qBAAqB,IACjBpG,KAAK,CAACuG,aAAN,CAAoBH,qBAApB,EAA2C;AAAE9E,IAAAA,MAAM,EAAEuB,aAAa,CAACU,OAAd,CAAsB,CAAtB,CAAV;AAAoC5B,IAAAA,cAAc,EAAEsD;AAApD,GAA3C,CANR,CAFyD,CAA7C,GAQgH,IARhI;AASA,MAAIkC,SAAS,GAAG,CAACb,OAAD,EAAUS,SAAV,CAAhB;AACA,MAAIK,MAAM,GAAIpH,KAAK,CAACuG,aAAN,CAAoB,MAApB,EAA4B;AAAEc,IAAAA,GAAG,EAAEtE,MAAP;AAAe+D,IAAAA,OAAO,EAAE3C,uBAAxB;AAAiDmD,IAAAA,WAAW,EAAEtD,iBAA9D;AAAiFwC,IAAAA,SAAS,EAAE,2CAA2Ce,OAAO,CAACpE,UAAU,EAAX,CAAP,GAAwB,WAAxB,GAAsC,EAAjF,CAA5F;AAAkLsD,IAAAA,GAAG,EAAE;AAAvL,GAA5B,EACVzG,KAAK,CAACuG,aAAN,CAAoB,MAApB,EAA4B;AAAEC,IAAAA,SAAS,EAAE;AAAb,GAA5B,CADU,CAAd;AAEA,MAAIgB,KAAK,GAAIxH,KAAK,CAACuG,aAAN,CAAoBtG,KAApB,EAA2B;AAAE8C,IAAAA,MAAM,EAAEA,MAAM,CAACtB,OAAjB;AAA0Bc,IAAAA,IAAI,EAAEA,IAAhC;AAAsCkE,IAAAA,GAAG,EAAE;AAA3C,GAA3B,EACTzG,KAAK,CAACuG,aAAN,CAAoB,KAApB,EAA2B;AAAEC,IAAAA,SAAS,EAAE,yBAAb;AAAwCa,IAAAA,GAAG,EAAErE,QAA7C;AAAuDyE,IAAAA,QAAQ,EAAE,CAAjE;AAAoE9D,IAAAA,MAAM,EAAEA,MAA5E;AAAoFI,IAAAA,OAAO,EAAEA,OAA7F;AAAsG2D,IAAAA,KAAK,EAAE;AAAEC,MAAAA,OAAO,EAAE;AAAX;AAA7G,GAA3B,EAA+JzG,KAAK,CAAC0G,WAAN,GAC3J1G,KAAK,CAAC0G,WAAN,CAAkB5I,IAAlB,CAAuBgG,SAAvB,EAAkCmC,SAAlC,EAA6C;AAAEzD,IAAAA,SAAS,EAAEA,SAAb;AAAwBrC,IAAAA,KAAK,EAAEA;AAA/B,GAA7C,CAD2J,GAE3J8F,SAFJ,CADS,CAAb;AAIA,MAAIU,SAAS,GAAG,CAACT,MAAD,EAASI,KAAT,CAAhB;AACA,SAAOxH,KAAK,CAACuG,aAAN,CAAoBvG,KAAK,CAAC8H,QAA1B,EAAoC,IAApC,EAA0C5G,KAAK,CAAC6G,MAAN,GAAe7G,KAAK,CAAC6G,MAAN,CAAa/I,IAAb,CAAkBgG,SAAlB,EAA6B6C,SAA7B,CAAf,GAAyDA,SAAnG,CAAP;AACH,CAnID;AAoIA;AACA;AACA;;;AACA,OAAO,IAAIG,oBAAoB,GAAG,UAAU9G,KAAV,EAAiB;AAC/C,MAAIG,KAAK,GAAGH,KAAK,CAACG,KAAlB;AAAA,MAAyB4G,MAAM,GAAG/I,MAAM,CAACgC,KAAD,EAAQ,CAAC,OAAD,CAAR,CAAxC;;AACA,MAAIU,aAAa,GAAG5B,KAAK,CAACoD,WAAN,CAAkB,UAAU8E,YAAV,EAAwB;AAC1D,WAAQ;AAAEnC,MAAAA,KAAK,EAAE,KAAT;AAAgBxC,MAAAA,OAAO,EAAE,CAAC;AAAE4E,QAAAA,QAAQ,EAAE,UAAZ;AAAwB9G,QAAAA,KAAK,EAAE6G,YAA/B;AAA6ClC,QAAAA,KAAK,EAAE;AAApD,OAAD,EAA2D;AAAEmC,QAAAA,QAAQ,EAAE,UAAZ;AAAwB9G,QAAAA,KAAK,EAAE6G,YAA/B;AAA6ClC,QAAAA,KAAK,EAAE;AAApD,OAA3D;AAAzB,KAAR;AACH,GAFmB,EAEjB,EAFiB,CAApB;AAGA,MAAIoC,QAAQ,GAAGb,OAAO,CAACrG,KAAK,CAACG,KAAP,CAAtB;AACA,MAAIa,aAAa,GAAGkG,QAAQ,GAAG,CAC3B/H,oBAD2B,EAE3BI,qBAF2B,EAG3BJ,oBAH2B,CAAH,GAIxB,EAJJ;AAKA,SAAQL,KAAK,CAACuG,aAAN,CAAoBtF,iBAApB,EAAuC7C,QAAQ,CAAC;AAAE0D,IAAAA,OAAO,EAAE,QAAQsG,QAAnB;AAA6BpG,IAAAA,QAAQ,EAAE,QAAQoG,QAA/C;AAAyDlG,IAAAA,aAAa,EAAEA,aAAxE;AAAuFN,IAAAA,aAAa,EAAEwG,QAAQ,GAAGxG,aAAH,GAAmBoD,SAAjI;AAA4I3D,IAAAA,KAAK,EAAEA;AAAnJ,GAAD,EAA6J4G,MAA7J,CAA/C,CAAR;AACH,CAZM;AAaP;AACA;AACA;;AACA,OAAO,IAAII,uBAAuB,GAAG,UAAUnH,KAAV,EAAiB;AAClD,MAAIG,KAAK,GAAGH,KAAK,CAACG,KAAlB;AAAA,MAAyB4G,MAAM,GAAG/I,MAAM,CAACgC,KAAD,EAAQ,CAAC,OAAD,CAAR,CAAxC;;AACA,MAAIU,aAAa,GAAG5B,KAAK,CAACoD,WAAN,CAAkB,UAAU8E,YAAV,EAAwB;AAC1D,WAAQ;AAAEnC,MAAAA,KAAK,EAAE,IAAT;AAAexC,MAAAA,OAAO,EAAE,CAAC;AAAE4E,QAAAA,QAAQ,EAAE,IAAZ;AAAkB9G,QAAAA,KAAK,EAAE6G,YAAzB;AAAuClC,QAAAA,KAAK,EAAE;AAA9C,OAAD,EAAuD;AAAEmC,QAAAA,QAAQ,EAAE,IAAZ;AAAkB9G,QAAAA,KAAK,EAAE6G,YAAzB;AAAuClC,QAAAA,KAAK,EAAE;AAA9C,OAAvD;AAAxB,KAAR;AACH,GAFmB,EAEjB,EAFiB,CAApB;AAGA,MAAIoC,QAAQ,GAAGb,OAAO,CAACrG,KAAK,CAACG,KAAP,CAAtB;AACA,MAAIa,aAAa,GAAGkG,QAAQ,GAAG,CAC3B9H,uBAD2B,EAE3BG,qBAF2B,EAG3BH,uBAH2B,CAAH,GAIxB,EAJJ;AAKA,SAAQN,KAAK,CAACuG,aAAN,CAAoBtF,iBAApB,EAAuC7C,QAAQ,CAAC;AAAE0D,IAAAA,OAAO,EAAE,QAAQsG,QAAnB;AAA6BpG,IAAAA,QAAQ,EAAE,QAAQoG,QAA/C;AAAyDlG,IAAAA,aAAa,EAAEA,aAAxE;AAAuFN,IAAAA,aAAa,EAAEwG,QAAQ,GAAGxG,aAAH,GAAmBoD,SAAjI;AAA4I3D,IAAAA,KAAK,EAAEA;AAAnJ,GAAD,EAA6J4G,MAA7J,CAA/C,CAAR;AACH,CAZM;AAaP;AACA;AACA;;AACA,OAAO,IAAIK,oBAAoB,GAAG,UAAUpH,KAAV,EAAiB;AAC/C,MAAIG,KAAK,GAAGH,KAAK,CAACG,KAAlB;AAAA,MAAyB4G,MAAM,GAAG/I,MAAM,CAACgC,KAAD,EAAQ,CAAC,OAAD,CAAR,CAAxC;;AACA,MAAIU,aAAa,GAAG5B,KAAK,CAACoD,WAAN,CAAkB,UAAU8E,YAAV,EAAwB;AAC1D,WAAQ;AAAEnC,MAAAA,KAAK,EAAE,IAAT;AAAexC,MAAAA,OAAO,EAAE,CAAC;AAAE4E,QAAAA,QAAQ,EAAE,IAAZ;AAAkB9G,QAAAA,KAAK,EAAE6G,YAAzB;AAAuClC,QAAAA,KAAK,EAAE;AAA9C,OAAD,EAAuD;AAAEmC,QAAAA,QAAQ,EAAE,IAAZ;AAAkB9G,QAAAA,KAAK,EAAE6G,YAAzB;AAAuClC,QAAAA,KAAK,EAAE;AAA9C,OAAvD;AAAxB,KAAR;AACH,GAFmB,EAEjB,EAFiB,CAApB;AAGA,MAAIoC,QAAQ,GAAGb,OAAO,CAACrG,KAAK,CAACG,KAAP,CAAtB;AACA,MAAIa,aAAa,GAAGkG,QAAQ,GAAG,CAC3B7H,oBAD2B,EAE3BE,qBAF2B,EAG3BF,oBAH2B,CAAH,GAIxB,EAJJ;AAKA,SAAQP,KAAK,CAACuG,aAAN,CAAoBtF,iBAApB,EAAuC7C,QAAQ,CAAC;AAAE0D,IAAAA,OAAO,EAAE,QAAQsG,QAAnB;AAA6BpG,IAAAA,QAAQ,EAAE,QAAQoG,QAA/C;AAAyDlG,IAAAA,aAAa,EAAEA,aAAxE;AAAuFN,IAAAA,aAAa,EAAEwG,QAAQ,GAAGxG,aAAH,GAAmBoD,SAAjI;AAA4I3D,IAAAA,KAAK,EAAEA;AAAnJ,GAAD,EAA6J4G,MAA7J,CAA/C,CAAR;AACH,CAZM;AAaP;AACA;AACA;;AACA,OAAO,IAAIM,uBAAuB,GAAG,UAAUrH,KAAV,EAAiB;AAClD,MAAIG,KAAK,GAAGH,KAAK,CAACG,KAAlB;AAAA,MAAyB4G,MAAM,GAAG/I,MAAM,CAACgC,KAAD,EAAQ,CAAC,OAAD,CAAR,CAAxC;;AACA,MAAIU,aAAa,GAAG5B,KAAK,CAACoD,WAAN,CAAkB,UAAU8E,YAAV,EAAwB;AAC1D,WAAQ;AAAEnC,MAAAA,KAAK,EAAE,KAAT;AAAgBxC,MAAAA,OAAO,EAAE,CAAC;AAAE4E,QAAAA,QAAQ,EAAE,IAAZ;AAAkB9G,QAAAA,KAAK,EAAE6G,YAAzB;AAAuClC,QAAAA,KAAK,EAAE;AAA9C,OAAD;AAAzB,KAAR;AACH,GAFmB,EAEjB,EAFiB,CAApB;AAGA,MAAIoC,QAAQ,GAAGb,OAAO,CAACrG,KAAK,CAACG,KAAP,CAAtB;AACA,MAAIa,aAAa,GAAGkG,QAAQ,GAAG,CAC3B5H,uBAD2B,CAAH,GAExB,EAFJ;AAGA,SAAQR,KAAK,CAACuG,aAAN,CAAoBtF,iBAApB,EAAuC7C,QAAQ,CAAC;AAAE0D,IAAAA,OAAO,EAAE,QAAQsG,QAAnB;AAA6BpG,IAAAA,QAAQ,EAAE,QAAQoG,QAA/C;AAAyDlG,IAAAA,aAAa,EAAEA,aAAxE;AAAuFN,IAAAA,aAAa,EAAEwG,QAAQ,GAAGxG,aAAH,GAAmBoD,SAAjI;AAA4I3D,IAAAA,KAAK,EAAEA;AAAnJ,GAAD,EAA6J4G,MAA7J,CAA/C,CAAR;AACH,CAVM","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport * as React from 'react';\nimport { Popup } from '@progress/kendo-react-popup';\nimport { useLocalization } from '@progress/kendo-react-intl';\nimport { isCompositeFilterDescriptor } from '@progress/kendo-data-query';\nimport { ColumnMenuItem } from './ColumnMenuItem';\nimport { ColumnMenuTextFilter, ColumnMenuNumericFilter, ColumnMenuDateFilter, ColumnMenuBooleanFilter } from './ColumnMenuFilters';\nimport { ColumnMenuFilterLogic } from './ColumnMenuFilterLogic';\nimport { ColumnMenuFilterForm } from './ColumnMenuFilterForm';\nimport { messages, columnMenuFilterTitle, columnMenuSortAscending, columnMenuSortDescending } from '../messages';\nimport { validatePackage } from '@progress/kendo-react-common';\nimport { packageMetadata } from '../package-metadata';\n/** @hidden */\nvar ColumnMenuWrapper = function (props) {\n    validatePackage(packageMetadata);\n    var emptySort = React.useRef([]);\n    var field = props.field, filter = props.filter, _a = props.sort, sort = _a === void 0 ? emptySort.current : _a, onSortChange = props.onSortChange, onFilterChange = props.onFilterChange, initialFilter = props.initialFilter, _b = props.sortAsc, sortAsc = _b === void 0 ? false : _b, _c = props.sortDesc, sortDesc = _c === void 0 ? false : _c, _d = props.filterContent, filterContent = _d === void 0 ? [] : _d, _e = props.expandFilters, expandFilters = _e === void 0 ? false : _e;\n    var _f = React.useState(false), show = _f[0], setShow = _f[1];\n    var _g = React.useState(expandFilters), filterExpand = _g[0], setFilterExpand = _g[1];\n    var _h = React.useState(field && initialFilter ? initialFilter(field) : null), currentFilter = _h[0], setCurrentFilter = _h[1];\n    var anchor = React.useRef(null);\n    var popupRef = React.useRef(null);\n    var blurTimeout = React.useRef(null);\n    var willBlur = React.useRef(false);\n    var menuFilter = React.useCallback(function () {\n        return (filter || []).find(function (f) { return f.filters.every(function (inF) { return !isCompositeFilterDescriptor(inF) && inF.field === field; }); });\n    }, [filter, field]);\n    var closeMenu = React.useCallback(function () {\n        setShow(false);\n    }, []);\n    var onBlur = React.useCallback(function () {\n        if (willBlur.current) {\n            willBlur.current = false;\n            return;\n        }\n        clearTimeout(blurTimeout.current);\n        blurTimeout.current = window.setTimeout(function () { closeMenu(); });\n    }, [closeMenu]);\n    var onFocus = React.useCallback(function () { return clearTimeout(blurTimeout.current); }, []);\n    var onAnchorMouseDown = React.useCallback(function (event) {\n        willBlur.current = show && event.currentTarget === anchor.current;\n    }, [show]);\n    var onColumnMenuButtonClick = React.useCallback(function () {\n        setShow(!show);\n        if (field && initialFilter) {\n            setFilterExpand(!show ? expandFilters : false);\n            setCurrentFilter(show ?\n                currentFilter :\n                (menuFilter() || initialFilter(field)));\n        }\n    }, [menuFilter, field, show, currentFilter, initialFilter, expandFilters]);\n    React.useEffect(function () {\n        if (show && popupRef.current) {\n            popupRef.current.focus();\n        }\n    }, [show]);\n    var filterItemClick = React.useCallback(function () { return setFilterExpand(!filterExpand); }, [filterExpand]);\n    var changeSort = React.useCallback(function (event, dir) {\n        var newSort = __spreadArray([], sort, true);\n        var currentSortIndex = newSort.findIndex(function (d) { return d.field === field; });\n        var newSortDescriptor = { field: field, dir: dir };\n        if (currentSortIndex >= 0) {\n            if (newSort[currentSortIndex].dir !== newSortDescriptor.dir) {\n                newSort.splice(currentSortIndex, 1, newSortDescriptor);\n            }\n            else {\n                newSort.splice(currentSortIndex, 1);\n            }\n        }\n        else {\n            newSort.push(newSortDescriptor);\n        }\n        closeMenu();\n        if (onSortChange) {\n            onSortChange.call(undefined, event, newSort, field);\n        }\n    }, [sort, field, onSortChange, closeMenu]);\n    var filterChange = React.useCallback(function (_event, nextFilter, prevFilter) {\n        var stateFilter = __assign(__assign({}, currentFilter), { filters: __spreadArray([], currentFilter.filters, true) });\n        var index = stateFilter.filters.indexOf(prevFilter);\n        stateFilter.filters.splice(index, 1, nextFilter);\n        setCurrentFilter(stateFilter);\n    }, [currentFilter]);\n    var onFilterSubmit = React.useCallback(function (event) {\n        event.preventDefault();\n        var newFilter = (filter || []).slice();\n        var prev = menuFilter();\n        var index = prev ? newFilter.indexOf(prev) : -1;\n        if (index >= 0) {\n            newFilter.splice(index, 1, currentFilter);\n        }\n        else {\n            newFilter.push(currentFilter);\n        }\n        closeMenu();\n        if (onFilterChange) {\n            onFilterChange.call(undefined, event, newFilter, field);\n        }\n    }, [filter, currentFilter, field, onFilterChange, closeMenu, menuFilter]);\n    var onFilterReset = React.useCallback(function (event) {\n        var newFilter = (filter || []).slice();\n        var prev = menuFilter();\n        var index = prev ? newFilter.indexOf(prev) : -1;\n        if (index >= 0) {\n            newFilter.splice(index, 1);\n        }\n        if (initialFilter) {\n            setCurrentFilter(initialFilter(field));\n        }\n        closeMenu();\n        if (onFilterChange) {\n            onFilterChange.call(undefined, event, newFilter, field);\n        }\n    }, [filter, field, onFilterChange, initialFilter, closeMenu, menuFilter]);\n    var sortAscChange = React.useCallback(function (e) { return changeSort(e, 'asc'); }, [changeSort]);\n    var sortDescChange = React.useCallback(function (e) { return changeSort(e, 'desc'); }, [changeSort]);\n    var onLogicChange = React.useCallback(function (event) { return currentFilter && setCurrentFilter(__assign(__assign({}, currentFilter), { logic: event.value.logic })); }, [currentFilter]);\n    var currentSort = sort.find(function (d) { return d.field === field; }) || { dir: '' };\n    var FirstFilterComponent = filterContent[0], FilterLogicComponent = filterContent[1], SecondFilterComponent = filterContent[2];\n    var localization = useLocalization();\n    var sorting = (sortAsc || sortDesc) ? (React.createElement(\"div\", { className: \"k-columnmenu-item-wrapper\", key: \"sorting\" },\n        sortAsc &&\n            (React.createElement(ColumnMenuItem, { title: localization.toLanguageString(columnMenuSortAscending, messages[columnMenuSortAscending]), iconClass: \"k-i-sort-asc-sm\", selected: currentSort.dir === 'asc', onClick: sortAscChange })),\n        sortDesc &&\n            (React.createElement(ColumnMenuItem, { title: localization.toLanguageString(columnMenuSortDescending, messages[columnMenuSortDescending]), iconClass: \"k-i-sort-desc-sm\", selected: currentSort.dir === 'desc', onClick: sortDescChange })))) : null;\n    // filter content empty when no field is supplied\n    var filtering = currentFilter && filterContent.length > 0 ? (React.createElement(\"div\", { className: \"k-columnmenu-item-wrapper\", key: \"filtering\" },\n        React.createElement(ColumnMenuItem, { iconClass: \"k-i-filter\", title: localization.toLanguageString(columnMenuFilterTitle, messages[columnMenuFilterTitle]), onClick: filterItemClick }),\n        React.createElement(ColumnMenuFilterForm, { show: filterExpand, onSubmit: onFilterSubmit, onReset: onFilterReset },\n            FirstFilterComponent &&\n                React.createElement(FirstFilterComponent, { filter: currentFilter.filters[0], onFilterChange: filterChange }),\n            FilterLogicComponent &&\n                React.createElement(FilterLogicComponent, { value: currentFilter.logic, onChange: onLogicChange }),\n            SecondFilterComponent &&\n                React.createElement(SecondFilterComponent, { filter: currentFilter.filters[1], onFilterChange: filterChange })))) : null;\n    var menuItems = [sorting, filtering];\n    var button = (React.createElement(\"span\", { ref: anchor, onClick: onColumnMenuButtonClick, onMouseDown: onAnchorMouseDown, className: 'k-grid-header-menu k-grid-column-menu' + (Boolean(menuFilter()) ? ' k-active' : ''), key: \"button\" },\n        React.createElement(\"span\", { className: \"k-icon k-i-more-vertical\" })));\n    var popup = (React.createElement(Popup, { anchor: anchor.current, show: show, key: \"popup\" },\n        React.createElement(\"div\", { className: \"k-grid-columnmenu-popup\", ref: popupRef, tabIndex: 0, onBlur: onBlur, onFocus: onFocus, style: { outline: 'none' } }, props.itemsRender ?\n            props.itemsRender.call(undefined, menuItems, { closeMenu: closeMenu, field: field }) :\n            menuItems)));\n    var rendering = [button, popup];\n    return React.createElement(React.Fragment, null, props.render ? props.render.call(undefined, rendering) : rendering);\n};\n/**\n * The `ColumnMenuTextColumn` component. Use it for `string` type columns.\n */\nexport var ColumnMenuTextColumn = function (props) {\n    var field = props.field, others = __rest(props, [\"field\"]);\n    var initialFilter = React.useCallback(function (currentField) {\n        return ({ logic: 'and', filters: [{ operator: 'contains', field: currentField, value: '' }, { operator: 'contains', field: currentField, value: '' }] });\n    }, []);\n    var hasField = Boolean(props.field);\n    var filterContent = hasField ? [\n        ColumnMenuTextFilter,\n        ColumnMenuFilterLogic,\n        ColumnMenuTextFilter\n    ] : [];\n    return (React.createElement(ColumnMenuWrapper, __assign({ sortAsc: true && hasField, sortDesc: true && hasField, filterContent: filterContent, initialFilter: hasField ? initialFilter : undefined, field: field }, others)));\n};\n/**\n * The `ColumnMenuNumericColumn` component. Use it for `number` type columns.\n */\nexport var ColumnMenuNumericColumn = function (props) {\n    var field = props.field, others = __rest(props, [\"field\"]);\n    var initialFilter = React.useCallback(function (currentField) {\n        return ({ logic: 'or', filters: [{ operator: 'eq', field: currentField, value: null }, { operator: 'eq', field: currentField, value: null }] });\n    }, []);\n    var hasField = Boolean(props.field);\n    var filterContent = hasField ? [\n        ColumnMenuNumericFilter,\n        ColumnMenuFilterLogic,\n        ColumnMenuNumericFilter\n    ] : [];\n    return (React.createElement(ColumnMenuWrapper, __assign({ sortAsc: true && hasField, sortDesc: true && hasField, filterContent: filterContent, initialFilter: hasField ? initialFilter : undefined, field: field }, others)));\n};\n/**\n * The `ColumnMenuDateColumn` component. Use it for `Date` type columns.\n */\nexport var ColumnMenuDateColumn = function (props) {\n    var field = props.field, others = __rest(props, [\"field\"]);\n    var initialFilter = React.useCallback(function (currentField) {\n        return ({ logic: 'or', filters: [{ operator: 'eq', field: currentField, value: null }, { operator: 'eq', field: currentField, value: null }] });\n    }, []);\n    var hasField = Boolean(props.field);\n    var filterContent = hasField ? [\n        ColumnMenuDateFilter,\n        ColumnMenuFilterLogic,\n        ColumnMenuDateFilter\n    ] : [];\n    return (React.createElement(ColumnMenuWrapper, __assign({ sortAsc: true && hasField, sortDesc: true && hasField, filterContent: filterContent, initialFilter: hasField ? initialFilter : undefined, field: field }, others)));\n};\n/**\n * The `ColumnMenuBooleanColumn` component. Use it for `boolean` type columns.\n */\nexport var ColumnMenuBooleanColumn = function (props) {\n    var field = props.field, others = __rest(props, [\"field\"]);\n    var initialFilter = React.useCallback(function (currentField) {\n        return ({ logic: 'and', filters: [{ operator: 'eq', field: currentField, value: false }] });\n    }, []);\n    var hasField = Boolean(props.field);\n    var filterContent = hasField ? [\n        ColumnMenuBooleanFilter\n    ] : [];\n    return (React.createElement(ColumnMenuWrapper, __assign({ sortAsc: true && hasField, sortDesc: true && hasField, filterContent: filterContent, initialFilter: hasField ? initialFilter : undefined, field: field }, others)));\n};\n"]},"metadata":{},"sourceType":"module"}